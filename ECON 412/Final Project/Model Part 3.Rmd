---
title: "Final project Part 3"
author: "Yiran Sun, Roya Latifi, Yiping Liu"
date: "2021/6/6"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo=FALSE, include=FALSE, warning=FALSE, message=FALSE}
library(caret)
library(ggplot2)
library(lares)


library(reshape) #for heatmap
library(glmnet)
library(MASS)
library(class)
library(FNN)
library(stats)
library(fpc)
library(e1071)
library(plyr)
library(dplyr)
library(corrplot)
library(gmodels)
library(dummies)
library(neuralnet)
library(nnet)


```

# 3 Introduction 

## 3.1 problem statement

### 3.1.1 Experiment Background

The experiments have been carried out with a group of 30 volunteers within an age bracket of 19-48 years. Each person performed six activities (WALKING, WALKINGUPSTAIRS, WALKINGDOWNSTAIRS, SITTING, STANDING, LAYING) wearing a smartphone (Samsung Galaxy S II) on the waist. Using its embedded accelerometer and gyroscope, researchers captured 3-axial linear acceleration and 3-axial angular velocity at a constant rate of 50Hz. The experiments have been video-recorded to label the data manually. 
The sensor signals (accelerometer and gyroscope) were pre-processed by applying noise filters and then sampled in fixed-width sliding windows of 2.56 sec and 50% overlap (128 readings/window). The sensor acceleration signal, which has gravitational and body motion components, was separated using a Butterworth low-pass filter into body acceleration and gravity. The gravitational force is assumed to have only low frequency components, therefore a filter with 0.3 Hz cutoff frequency was used. From each window, a vector of features was obtained by calculating variables from the time and frequency domain.

<br>

### 3.1.2 Data Description 

We got this database, "Human Activity Recognition", from UCI machine learning dataset. The Human Activity Recognition database was built from the recordings of 30 study participants performing activities of daily living (ADL) while carrying a waist-mounted smartphone with embedded inertial sensors. The objective is to classify activities into one of the six activities performed.

There was totally 563 variables in our database, with 561 features from the accelerometer and gyroscope and some calculation methods. And there is one "subject" column identifying the participants. The dependent variable is named "activity" at last, including six activities, WALKING, WALKINGUPSTAIRS, WALKINGDOWNSTAIRS, SITTING, STANDING, LAYING. 

The researchers obtained features in the following steps: 
- (i) Firstly, features selected come from the accelerometer and gyroscope 3-axial raw signals tAcc-XYZ and tGyro-XYZ. These are time domain signals captured at a constant rate of 50 Hz. Then they were filtered using a median filter and a 3rd order low pass Butterworth filter with a corner frequency of 20 Hz to remove noise.'-XYZ' is used to denote 3-axial signals in the X, Y and Z directions.

- (ii) Then are the acceleration signals, tBodyAcc-XYZ and tGravityAcc-XYZ, they were seperated into body and gravity accelerations features by another low pass Butterworth filter with a corner frequency of 0.3 Hz. 

- (iii) Thirdly, researchers obtained Jerk Signals, tBodyAccJerk-XYZ and tBodyGyroJerk-XYZ, which are the body linear acceleration and angular velocity derived in time. 

-(iv) Subsequently, the Euclidean norm calculation method has been included to get tBodyAccMag, tGravityAccMag, tBodyAccJerkMag, tBodyGyroMag, tBodyGyroJerkMag. These five variables show the magnitude of these three-dimensional signals.

-(v) Finally, another method, a Fast Fourier Transform (FFT) was applied. And fBodyAcc-XYZ, fBodyAccJerk-XYZ, fBodyGyro-XYZ, fBodyAccJerkMag, fBodyGyroMag, fBodyGyroJerkMag variables have been generated. Here,  the 'f' to indicate frequency domain signals. 

After getting all the features, researchers calculate the mean, standard deviation, signal magnitude etc for each repeating experiments. These calculation results, along with the data obtained from Euclidean norm and Fast Fourier Transform are the ones included in these data base. The description of abbreviation from data processing methods are listed as below: 

* mean(): Mean value

* std(): Standard deviation

* mad(): Median absolute deviation

* max(): Largest value in array

* min(): Smallest value in array

* sma(): Signal magnitude area

* energy(): Energy measure. Sum of the squares divided by the number of values. 

* iqr(): Interquartile range 

* entropy(): Signal entropy

* arCoeff(): Autorregresion coefficients with Burg order equal to 4

* correlation(): correlation coefficient between two signals

* maxInds(): index of the frequency component with largest magnitude

* meanFreq(): Weighted average of the frequency components to obtain a mean frequency

* skewness(): skewness of the frequency domain signal 

* kurtosis(): kurtosis of the frequency domain signal 

* bandsEnergy(): Energy of a frequency interval within the 64 bins of the FFT of each window.

* angle(): Angle between to vectors.

The obtained data base has been randomly partitioned into two sets, where 70% of the volunteers was selected for generating the training data and 30% the test data. As we can see from the "dim" function, the train data has 7352 observations and the testing dataset has 2947 observations. 


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
## load dataset
#setwd("C:/Users/evayp/Desktop/final project")
da.train <- read.csv("train.csv")
da.test <- read.csv("test.csv")

all <- rbind(da.train,da.test) #combine train and test data 
dim(da.train)
dim(da.test)
#head(all)
```

#### Checking Missing Values
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
## checking for NAs in the whole dataset
a <- names(all)
b <- data.frame()
null_df <- data.frame()
for (i in a){
  c <- sum(is.na(all[,i]))
  b <- data.frame("Feature name"=i,"num of NAs"=c)
  null_df <-rbind(null_df,b)}
print(null_df)
print(sum(null_df[,2]))
### As we can see from the printing results, there is no NA in our dataset. 
```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
#checking the duplicates
sum(duplicated(all))
```
As we can see from the sum, there is no duplicates in our dataset. 




#### Investigating correlations

After generating a basic idea from the data description in words, we are going to investigate the correlations among these variables and produce some visualization for our variables to gain a deeper view for these. At first, we use the "findCorrelation" from caret library to return the pairs of variables with significant correlation in the whole data base.


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
findCorrelation(all[,c(1:562)],cutoff = 0.95,verbose = FALSE,names = TRUE)
```

From the results, we notice that in general, variables in the same experiment procedure tend to obtain significant correlations. So next, we are going to visualize top correlated variables based on experiment process. 

**(1) tBodyAcc-XYZ and tGravityAcc-XYZ**

From the experiment description, we know researcher first get the accelerometer and gyroscope 3-axial raw signals and then transformed them into tBodyAcc-XYZ and tGravityAcc-XYZ with mean, standard deviation, median absolute deviation etc calculations. So initially, we would like to see the corelations among this variables. 

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}

tbg<-all[,c(1:80)] #abbreviation of tBody and tGravity

corr_cross(tbg, # name of dataset
  max_pvalue = 0.05, # display only significant correlations (at 5% level)
  top = 15 # display top 10 couples of variables (by correlation coefficient)
)

```

From this plot, we could see most highly correlated variables are gravity acceleration signals. 

Only arCoefficiencies in Z axis have the negative correlations in the top 15 couples. 


**(2) Jerk signals: tBodyAccJerk-XYZ and tBodyGyroJerk-XYZ**

Subsequently, researchers obtain Jerk Signals to analyze linear acceleration and angular velocity. 

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
jerk<-all[,c(81:200)]
corr_cross(jerk, # name of dataset
  max_pvalue = 0.05, # display only significant correlations (at 5% level)
  top = 15 # display top 15 couples of variables (by correlation coefficient)
)
```

From this picture, we know in general, standard deviation and median absolute deviation in the same axis return the highest correlation. And X axis correlate more closely than other axis. 

**(3) Magnitude**

Then the scientists calculate the Euclidean norm to investigate the magnitude of three dimensional signals. The variables are named as tBodyAccMag, tGravityAccMag, tBodyAccJerkMag, tBodyGyroMag, tBodyGyroJerkMag. 

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
mag<-all[,c(201:265)]
corr_cross(mag, # name of dataset
  max_pvalue = 0.05, # display only significant correlations (at 5% level)
  top = 15 # display top 15 couples of variables (by correlation coefficient)
)
```

As for different type of Euclidean norm, we notice that tBodyAccMag has the highest correlation with tGravityAccMag.

**(4)Fast fourier transform**

In the last step of this experiment, researchers applied FFT to these signals and also averaged the signals in a signal window sample to get the angle variable. 

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
fft<-all[,c(266:561)]
corr_cross(fft, # name of dataset
  max_pvalue = 0.05, # display only significant correlations (at 5% level)
  top = 15 # display top 15 couples of variables (by correlation coefficient)
)
```

We notice that correlation of the top three pairs is 1, and that energy of a frequency interval with 1 and 24 bins of the FFT of each window seem to have high correlation with fBodyAcc and fBodyGyro energy in x axis. 

After visualizing the dependent variable, we would like to attempt some visualization for our dependent variable, "activity".

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}

da.train$Partition = "Train"
da.test$Partition = "Test"
ind.all = rbind(da.train,da.test) #create another dataset for independent variable visualization 
# with test and train data partition
ind.all$Partition = as.factor(ind.all$Partition)
qplot(data = ind.all, x = subject, ylab="count",fill = Partition)
qplot(data = ind.all , x = subject, fill = Activity)

```

The total number of experiments performed on testing participants is approximately 1:3 to the one for training participants.

The first plot tells us the testing data has been selected from participants all with subject id 2,4,9,10,12,13,18,20,24. But since we have no idea if different people have different preference while making guestures, we decide to split the whole dataset into training and testing smaples randomly again.  

From the second plot, we could see that each participants have go through the experiments with all six activities in an even distribution. 

#### Split training and testing dataset


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412.3)
train.index <- sample(c(1:dim(all)[1]), dim(all)[1]*0.8)

factor(all$subject )
train.data <- all[train.index,]
valid.data <- all[-train.index, ] 

# check if training contains all the subject
da.train <- train.data
da.test <- valid.data

da.train$Partition = "Train"
da.test$Partition = "Test"

ind.all = rbind(da.train,da.test) #create another dataset for independent variable visualization 
# with test and train data partition
ind.all$Partition = as.factor(ind.all$Partition)
qplot(data = ind.all, x = subject, ylab="count",fill = Partition)
#qplot(data = train.data, x = subject, ylab="count")
#qplot(data = ind.all , x = subject, fill = Activity)

```





Now they both contains all subjects.






```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
x.train = train.data[, -563]
#x.train = factor(x.train)

y.train = train.data$Activity
y.train = factor(y.train)


x.valid = valid.data[, -563]
#y.valid = factor(y.valid)

y.valid = valid.data$Activity
y.valid = factor(y.valid)
```

# 6. Random Forest

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412) 
train.control <- trainControl(method = "cv", number = 5)
rf.model <- train(x=x.train, y=y.train, method = "rf",trControl = train.control)

print(rf.model)
```

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
plot(rf.model)
rf.model$finalModel
plot(rf.model$finalModel)
```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
library(dplyr)
library(ggraph)
library(igraph)

tree_func <- function(final_model, 
                      tree_num) {
  
  # get tree by index
  tree <- randomForest::getTree(final_model, 
                                k = tree_num, 
                                labelVar = TRUE) %>%
    tibble::rownames_to_column() %>%
    # make leaf split points to NA, so the 0s won't get plotted
    mutate(`split point` = ifelse(is.na(prediction), `split point`, NA))
  
  # prepare data frame for graph
  graph_frame <- data.frame(from = rep(tree$rowname, 2),
                            to = c(tree$`left daughter`, tree$`right daughter`))
  
  # convert to graph and delete the last node that we don't want to plot
  graph <- graph_from_data_frame(graph_frame) %>%
    delete_vertices("0")
  
  # set node labels
  V(graph)$node_label <- gsub("_", " ", as.character(tree$`split var`))
  V(graph)$leaf_label <- as.character(tree$prediction)
  V(graph)$split <- as.character(round(tree$`split point`, digits = 2))
  
  # plot
  plot <- ggraph(graph, 'dendrogram') + 
    theme_bw() +
    geom_edge_link() +
    geom_node_point() +
    geom_node_text(aes(label = node_label), na.rm = TRUE, repel = TRUE) +
    geom_node_label(aes(label = split), vjust = 2.5, na.rm = TRUE, fill = "white") +
    geom_node_label(aes(label = leaf_label, fill = leaf_label), na.rm = TRUE, 
					repel = TRUE, colour = "white", fontface = "bold", show.legend = FALSE) +
    theme(panel.grid.minor = element_blank(),
          panel.grid.major = element_blank(),
          panel.background = element_blank(),
          plot.background = element_rect(fill = "white"),
          panel.border = element_blank(),
          axis.line = element_blank(),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.ticks = element_blank(),
          axis.title.x = element_blank(),
          axis.title.y = element_blank(),
          plot.title = element_text(size = 18))
  
  print(plot)
}


```




```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
tree_num <- which(rf.model$finalModel$forest$ndbigtree == min(rf.model$finalModel$forest$ndbigtree))
tree_num
#tree_func(final_model = rf.model$finalModel, tree_num)
```



#### Training on testing samples

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
#Predict using the testing data
y_hat_rf = predict(rf.model, x.train)

p_lin_train= mean(y_hat_rf==train.data$Activity)
p_lin_train
```






### Predict on the testing data
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
rf.pred <- predict(rf.model, x.valid)
```

### Evaluate prediction result
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Evaluate with Confusion matrix
rf.matrix <- confusionMatrix(rf.pred, y.valid, positive="1", mode="everything")
print(rf.matrix)
```



# 7. SVM

A support vector machine takes data points and outputs the hyperplane that best separates the tags. Kernel is better for making optimization when there are many features. Although Kernel SVM is more widely used as a non-linear classification model to classify binary results by projecting data into a higher dimension without increasing too much complexity of loss function, nowadays we can also apply it to regression data. And we usually refer to it as `Support Vector Regression`.



<br>


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412) 

svm.model <- train(x=x.train, y=y.train, method = "svmLinear2", trControl = train.control)

print(svm.model)

```



#### Training on testing samples

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
#Predict using the testing data
y_hat_svm = predict(svm.model, x.train)

p_lin_train= mean(y_hat_svm==train.data$Activity)
p_lin_train
```

#### Testing on testing samples
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
svm.pred <- predict(svm.model, x.valid)

# Evaluate with Confusion matrix
svm.matrix <- confusionMatrix(svm.pred, y.valid, mode="everything")

print(svm.matrix)

```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
#find the optimal model
#set.seed(412)
#opt.svm <- tune(svm, train.x=x.train, train.y=y.train,cost=1:10,
#                tunecontrol=tune.control(sampling = "cross"), cross=5)
#print(opt.svm)

# extract the best model
#best.svm <- opt.svm$best.model
#best.svm

```
#### Training on testing samples

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Predict using the testing data
#y_hat_svm = predict(best.svm, x.train)

#p_lin_train= mean(y_hat_svm==train.data$Activity)
#p_lin_train
```

#### Testing on testing samples

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Predict using the testing data
#y_hat_svm = predict(best.svm, x.valid)

#p_lin= mean(y_hat_svm==valid.data$Activity)
#p_lin
```




In Support Vector Regression, support vectors are points that find the closest match between the data points and the actual function that is represented by them. The CV process finds the optimal number of support vectors that find the closest match between the data points. The final value used for the model was cost = 0.5.

<br>



# 8. K-Nearest Neighbor(KNN)

Different from the prior models which are parametric models, K-Nearest Neighbor (KNN) is a non-parametric approach and it works well when the decision boundary is highly non-linear. 


For KNN model, we need to choose the optimal number of K to establish the model at first. We build a for loop and compare the accuracy of different Ks to select the best one. 




```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
cvBreaks = 5
temp = sample(levels(factor(train.data$subject)), length(levels(factor(train.data$subject))))  # randomize subjects
temp = split(temp, cut(1:length(temp), breaks = cvBreaks, labels = FALSE))  # split into CV groups
cvGroupIndices = lapply(temp, function(X) {
    which(!train.data$subject %in% X)
})

```


#### Fit the train data and test on the validation set

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
knnCtrl = trainControl(method = "cv", number = length(cvGroupIndices), index = cvGroupIndices, 
        classProbs = TRUE)
modelKnn = train(train.data[, -563], train.data[, 563], method = "knn", 
trControl = knnCtrl, tuneGrid = data.frame(.k = c(2,5, 10, 15, 20)))
print(modelKnn)

confusionMatrix(modelKnn)
plot(modelKnn)
```


From the results, we could see the model accuracies for different K values. And when k=15, it returns the highest accuracy result. 

<br><br>


### Fitting knn model with k=15

#### Training on testing samples

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
#Predict using the testing data
y_hat_KNN = predict(modelKnn, x.train)

p_lin_train= mean(y_hat_KNN==train.data$Activity)
p_lin_train
```



### Testing the model on the testing sample
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# prediction on validation dataset
knn.pred <- predict(modelKnn, x.valid)

# Evaluate with Confusion matrix
knn.matrix <- confusionMatrix(knn.pred, y.valid, mode="everything")

print(knn.matrix)

```





# 9. Neural Networks



#NN6 hidden = 2
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
nn6 <- neuralnet((Activity == "LAYING") + (Activity == "SITTING")+ (Activity == "STANDING")+ (Activity == "WALKING") + (Activity == "WALKING_DOWNSTAIRS") + (Activity == "WALKING_UPSTAIRS") ~ tBodyAcc.mean...X + tBodyAcc.mean...Y + tBodyAcc.mean...Z + tBodyAcc.std...X + 
    tBodyAcc.std...Y + tBodyAcc.std...Z + tBodyAcc.mad...X + 
    tBodyAcc.mad...Y + tBodyAcc.mad...Z + tBodyAcc.max...X + 
    tBodyAcc.max...Y + tBodyAcc.max...Z + tBodyAcc.min...X + 
    tBodyAcc.min...Y + tBodyAcc.min...Z + tBodyAcc.sma.. + tBodyAcc.energy...X + 
    tBodyAcc.energy...Y + tBodyAcc.energy...Z + tBodyAcc.iqr...X + 
    tBodyAcc.iqr...Y + tBodyAcc.iqr...Z + tBodyAcc.entropy...X + 
    tBodyAcc.entropy...Y + tBodyAcc.entropy...Z + tBodyAcc.arCoeff...X.1 + 
    tBodyAcc.arCoeff...X.2 + tBodyAcc.arCoeff...X.3 + tBodyAcc.arCoeff...X.4 + 
    tBodyAcc.arCoeff...Y.1 + tBodyAcc.arCoeff...Y.2 + tBodyAcc.arCoeff...Y.3 + 
    tBodyAcc.arCoeff...Y.4 + tBodyAcc.arCoeff...Z.1 + tBodyAcc.arCoeff...Z.2 + 
    tBodyAcc.arCoeff...Z.3 + tBodyAcc.arCoeff...Z.4 + tBodyAcc.correlation...X.Y + 
    tBodyAcc.correlation...X.Z + tBodyAcc.correlation...Y.Z + 
    tGravityAcc.mean...X + tGravityAcc.mean...Y + tGravityAcc.mean...Z + 
    tGravityAcc.std...X + tGravityAcc.std...Y + tGravityAcc.std...Z + 
    tGravityAcc.mad...X + tGravityAcc.mad...Y + tGravityAcc.mad...Z + 
    tGravityAcc.max...X + tGravityAcc.max...Y + tGravityAcc.max...Z + 
    tGravityAcc.min...X + tGravityAcc.min...Y + tGravityAcc.min...Z + 
    tGravityAcc.sma.. + tGravityAcc.energy...X + tGravityAcc.energy...Y + 
    tGravityAcc.energy...Z + tGravityAcc.iqr...X + tGravityAcc.iqr...Y + 
    tGravityAcc.iqr...Z + tGravityAcc.entropy...X + tGravityAcc.entropy...Y + 
    tGravityAcc.entropy...Z + tGravityAcc.arCoeff...X.1 + tGravityAcc.arCoeff...X.2 + 
    tGravityAcc.arCoeff...X.3 + tGravityAcc.arCoeff...X.4 + tGravityAcc.arCoeff...Y.1 + 
    tGravityAcc.arCoeff...Y.2 + tGravityAcc.arCoeff...Y.3 + tGravityAcc.arCoeff...Y.4 + 
    tGravityAcc.arCoeff...Z.1 + tGravityAcc.arCoeff...Z.2 + tGravityAcc.arCoeff...Z.3 + 
    tGravityAcc.arCoeff...Z.4 + tGravityAcc.correlation...X.Y + 
    tGravityAcc.correlation...X.Z + tGravityAcc.correlation...Y.Z + 
    tBodyAccJerk.mean...X + tBodyAccJerk.mean...Y + tBodyAccJerk.mean...Z + 
    tBodyAccJerk.std...X + tBodyAccJerk.std...Y + tBodyAccJerk.std...Z + 
    tBodyAccJerk.mad...X + tBodyAccJerk.mad...Y + tBodyAccJerk.mad...Z + 
    tBodyAccJerk.max...X + tBodyAccJerk.max...Y + tBodyAccJerk.max...Z + 
    tBodyAccJerk.min...X + tBodyAccJerk.min...Y + tBodyAccJerk.min...Z + 
    tBodyAccJerk.sma.. + tBodyAccJerk.energy...X + tBodyAccJerk.energy...Y + 
    tBodyAccJerk.energy...Z + tBodyAccJerk.iqr...X + tBodyAccJerk.iqr...Y + 
    tBodyAccJerk.iqr...Z + tBodyAccJerk.entropy...X + tBodyAccJerk.entropy...Y + 
    tBodyAccJerk.entropy...Z + tBodyAccJerk.arCoeff...X.1 + tBodyAccJerk.arCoeff...X.2 + 
    tBodyAccJerk.arCoeff...X.3 + tBodyAccJerk.arCoeff...X.4 + 
    tBodyAccJerk.arCoeff...Y.1 + tBodyAccJerk.arCoeff...Y.2 + 
    tBodyAccJerk.arCoeff...Y.3 + tBodyAccJerk.arCoeff...Y.4 + tBodyAccJerk.arCoeff...Z.1 + tBodyAccJerk.arCoeff...Z.2 + 
    tBodyAccJerk.arCoeff...Z.3 + tBodyAccJerk.arCoeff...Z.4 + 
    tBodyAccJerk.correlation...X.Y + tBodyAccJerk.correlation...X.Z + 
    tBodyAccJerk.correlation...Y.Z + tBodyGyro.mean...X + tBodyGyro.mean...Y + 
    tBodyGyro.mean...Z + tBodyGyro.std...X + tBodyGyro.std...Y + 
    tBodyGyro.std...Z + tBodyGyro.mad...X + tBodyGyro.mad...Y + 
    tBodyGyro.mad...Z + tBodyGyro.max...X + tBodyGyro.max...Y + 
    tBodyGyro.max...Z + tBodyGyro.min...X + tBodyGyro.min...Y + 
    tBodyGyro.min...Z + tBodyGyro.sma.. + tBodyGyro.energy...X + 
    tBodyGyro.energy...Y + tBodyGyro.energy...Z + tBodyGyro.iqr...X + 
    tBodyGyro.iqr...Y + tBodyGyro.iqr...Z + tBodyGyro.entropy...X + 
    tBodyGyro.entropy...Y + tBodyGyro.entropy...Z + tBodyGyro.arCoeff...X.1 + 
    tBodyGyro.arCoeff...X.2 + tBodyGyro.arCoeff...X.3 + tBodyGyro.arCoeff...X.4 + 
    tBodyGyro.arCoeff...Y.1 + tBodyGyro.arCoeff...Y.2 + tBodyGyro.arCoeff...Y.3 + 
    tBodyGyro.arCoeff...Y.4 + tBodyGyro.arCoeff...Z.1 + tBodyGyro.arCoeff...Z.2 + 
    tBodyGyro.arCoeff...Z.3 + tBodyGyro.arCoeff...Z.4 + tBodyGyro.correlation...X.Y + 
    tBodyGyro.correlation...X.Z + tBodyGyro.correlation...Y.Z + 
    tBodyGyroJerk.mean...X + tBodyGyroJerk.mean...Y + tBodyGyroJerk.mean...Z + 
    tBodyGyroJerk.std...X + tBodyGyroJerk.std...Y + tBodyGyroJerk.std...Z + 
    tBodyGyroJerk.mad...X + tBodyGyroJerk.mad...Y + tBodyGyroJerk.mad...Z + 
    tBodyGyroJerk.max...X + tBodyGyroJerk.max...Y + tBodyGyroJerk.max...Z + 
    tBodyGyroJerk.min...X + tBodyGyroJerk.min...Y + tBodyGyroJerk.min...Z + 
    tBodyGyroJerk.sma.. + tBodyGyroJerk.energy...X + tBodyGyroJerk.energy...Y + 
    tBodyGyroJerk.energy...Z + tBodyGyroJerk.iqr...X + tBodyGyroJerk.iqr...Y + 
    tBodyGyroJerk.iqr...Z + tBodyGyroJerk.entropy...X + tBodyGyroJerk.entropy...Y + 
    tBodyGyroJerk.entropy...Z + tBodyGyroJerk.arCoeff...X.1 + 
    tBodyGyroJerk.arCoeff...X.2 + tBodyGyroJerk.arCoeff...X.3 + 
    tBodyGyroJerk.arCoeff...X.4 + tBodyGyroJerk.arCoeff...Y.1 + 
    tBodyGyroJerk.arCoeff...Y.2 + tBodyGyroJerk.arCoeff...Y.3 + 
    tBodyGyroJerk.arCoeff...Y.4 + tBodyGyroJerk.arCoeff...Z.1 + 
    tBodyGyroJerk.arCoeff...Z.2 + tBodyGyroJerk.arCoeff...Z.3 + 
    tBodyGyroJerk.arCoeff...Z.4 + tBodyGyroJerk.correlation...X.Y + 
    tBodyGyroJerk.correlation...X.Z + tBodyGyroJerk.correlation...Y.Z + 
    tBodyAccMag.mean.. + tBodyAccMag.std.. + tBodyAccMag.mad.. + 
    tBodyAccMag.max.. + tBodyAccMag.min.. + tBodyAccMag.sma.. + 
    tBodyAccMag.energy.. + tBodyAccMag.iqr.. + tBodyAccMag.entropy.. + 
    tBodyAccMag.arCoeff..1 + tBodyAccMag.arCoeff..2 + tBodyAccMag.arCoeff..3 + 
    tBodyAccMag.arCoeff..4 + tGravityAccMag.mean.. + tGravityAccMag.std.. + 
    tGravityAccMag.mad.. + tGravityAccMag.max.. + tGravityAccMag.min.. + 
    tGravityAccMag.sma.. + tGravityAccMag.energy.. + tGravityAccMag.iqr.. + 
    tGravityAccMag.entropy.. + tGravityAccMag.arCoeff..1 + tGravityAccMag.arCoeff..2 + 
    tGravityAccMag.arCoeff..3 + tGravityAccMag.arCoeff..4 + tBodyAccJerkMag.mean.. + 
    tBodyAccJerkMag.std.. + tBodyAccJerkMag.mad.. + tBodyAccJerkMag.max.. + 
    tBodyAccJerkMag.min.. + tBodyAccJerkMag.sma.. + tBodyAccJerkMag.energy.. + 
    tBodyAccJerkMag.iqr.. + tBodyAccJerkMag.entropy.. + tBodyAccJerkMag.arCoeff..1 + 
    tBodyAccJerkMag.arCoeff..2 + tBodyAccJerkMag.arCoeff..3 + 
    tBodyAccJerkMag.arCoeff..4 + tBodyGyroMag.mean.. + tBodyGyroMag.std.. + 
    tBodyGyroMag.mad.. + tBodyGyroMag.max.. + tBodyGyroMag.min.. + 
    tBodyGyroMag.sma.. + tBodyGyroMag.energy.. + tBodyGyroMag.iqr.. + 
    tBodyGyroMag.entropy.. + tBodyGyroMag.arCoeff..1 + tBodyGyroMag.arCoeff..2 + 
    tBodyGyroMag.arCoeff..3 + tBodyGyroMag.arCoeff..4 + tBodyGyroJerkMag.mean.. + 
    tBodyGyroJerkMag.std.. + tBodyGyroJerkMag.mad.. + tBodyGyroJerkMag.max.. + 
    tBodyGyroJerkMag.min.. + tBodyGyroJerkMag.sma.. + tBodyGyroJerkMag.energy.. + 
    tBodyGyroJerkMag.iqr.. + tBodyGyroJerkMag.entropy.. + tBodyGyroJerkMag.arCoeff..1 + 
    tBodyGyroJerkMag.arCoeff..2 + tBodyGyroJerkMag.arCoeff..3 +tBodyGyroJerkMag.arCoeff..4 + fBodyAcc.mean...X + fBodyAcc.mean...Y + 
    fBodyAcc.mean...Z + fBodyAcc.std...X + fBodyAcc.std...Y + 
    fBodyAcc.std...Z + fBodyAcc.mad...X + fBodyAcc.mad...Y + 
    fBodyAcc.mad...Z + fBodyAcc.max...X + fBodyAcc.max...Y + 
    fBodyAcc.max...Z + fBodyAcc.min...X + fBodyAcc.min...Y + 
    fBodyAcc.min...Z + fBodyAcc.sma.. + fBodyAcc.energy...X + 
    fBodyAcc.energy...Y + fBodyAcc.energy...Z + fBodyAcc.iqr...X + 
    fBodyAcc.iqr...Y + fBodyAcc.iqr...Z + fBodyAcc.entropy...X + 
    fBodyAcc.entropy...Y + fBodyAcc.entropy...Z + fBodyAcc.maxInds.X + 
    fBodyAcc.maxInds.Y + fBodyAcc.maxInds.Z + fBodyAcc.meanFreq...X + 
    fBodyAcc.meanFreq...Y + fBodyAcc.meanFreq...Z + fBodyAcc.skewness...X + 
    fBodyAcc.kurtosis...X + fBodyAcc.skewness...Y + fBodyAcc.kurtosis...Y + 
    fBodyAcc.skewness...Z + fBodyAcc.kurtosis...Z + fBodyAcc.bandsEnergy...1.8 + 
    fBodyAcc.bandsEnergy...9.16 + fBodyAcc.bandsEnergy...17.24 + 
    fBodyAcc.bandsEnergy...25.32 + fBodyAcc.bandsEnergy...33.40 + 
    fBodyAcc.bandsEnergy...41.48 + fBodyAcc.bandsEnergy...49.56 + 
    fBodyAcc.bandsEnergy...57.64 + fBodyAcc.bandsEnergy...1.16 + 
    fBodyAcc.bandsEnergy...17.32 + fBodyAcc.bandsEnergy...33.48 + 
    fBodyAcc.bandsEnergy...49.64 + fBodyAcc.bandsEnergy...1.24 + 
    fBodyAcc.bandsEnergy...25.48 + fBodyAcc.bandsEnergy...1.8.1 + 
    fBodyAcc.bandsEnergy...9.16.1 + fBodyAcc.bandsEnergy...17.24.1 + 
    fBodyAcc.bandsEnergy...25.32.1 + fBodyAcc.bandsEnergy...33.40.1 + 
    fBodyAcc.bandsEnergy...41.48.1 + fBodyAcc.bandsEnergy...49.56.1 + 
    fBodyAcc.bandsEnergy...57.64.1 + fBodyAcc.bandsEnergy...1.16.1 + 
    fBodyAcc.bandsEnergy...17.32.1 + fBodyAcc.bandsEnergy...33.48.1 + 
    fBodyAcc.bandsEnergy...49.64.1 + fBodyAcc.bandsEnergy...1.24.1 + 
    fBodyAcc.bandsEnergy...25.48.1 + fBodyAcc.bandsEnergy...1.8.2 + 
    fBodyAcc.bandsEnergy...9.16.2 + fBodyAcc.bandsEnergy...17.24.2 + 
    fBodyAcc.bandsEnergy...25.32.2 + fBodyAcc.bandsEnergy...33.40.2 + 
    fBodyAcc.bandsEnergy...41.48.2 + fBodyAcc.bandsEnergy...49.56.2 + 
    fBodyAcc.bandsEnergy...57.64.2 + fBodyAcc.bandsEnergy...1.16.2 + 
    fBodyAcc.bandsEnergy...17.32.2 + fBodyAcc.bandsEnergy...33.48.2 + 
    fBodyAcc.bandsEnergy...49.64.2 + fBodyAcc.bandsEnergy...1.24.2 + 
    fBodyAcc.bandsEnergy...25.48.2 + fBodyAccJerk.mean...X + 
    fBodyAccJerk.mean...Y + fBodyAccJerk.mean...Z + fBodyAccJerk.std...X + 
    fBodyAccJerk.std...Y + fBodyAccJerk.std...Z + fBodyAccJerk.mad...X + 
    fBodyAccJerk.mad...Y + fBodyAccJerk.mad...Z + fBodyAccJerk.max...X + 
    fBodyAccJerk.max...Y + fBodyAccJerk.max...Z + fBodyAccJerk.min...X + 
    fBodyAccJerk.min...Y + fBodyAccJerk.min...Z + fBodyAccJerk.sma.. + 
    fBodyAccJerk.energy...X + fBodyAccJerk.energy...Y + fBodyAccJerk.energy...Z + 
    fBodyAccJerk.iqr...X + fBodyAccJerk.iqr...Y + fBodyAccJerk.iqr...Z + 
    fBodyAccJerk.entropy...X + fBodyAccJerk.entropy...Y + fBodyAccJerk.entropy...Z + 
    fBodyAccJerk.maxInds.X + fBodyAccJerk.maxInds.Y + fBodyAccJerk.maxInds.Z + 
    fBodyAccJerk.meanFreq...X + fBodyAccJerk.meanFreq...Y + fBodyAccJerk.meanFreq...Z + 
    fBodyAccJerk.skewness...X + fBodyAccJerk.kurtosis...X + fBodyAccJerk.skewness...Y + 
    fBodyAccJerk.kurtosis...Y + fBodyAccJerk.skewness...Z + fBodyAccJerk.kurtosis...Z + 
    fBodyAccJerk.bandsEnergy...1.8 + fBodyAccJerk.bandsEnergy...9.16 + 
    fBodyAccJerk.bandsEnergy...17.24 + fBodyAccJerk.bandsEnergy...25.32 + 
    fBodyAccJerk.bandsEnergy...33.40 + fBodyAccJerk.bandsEnergy...41.48 + 
    fBodyAccJerk.bandsEnergy...49.56 + fBodyAccJerk.bandsEnergy...57.64 + 
    fBodyAccJerk.bandsEnergy...1.16 + fBodyAccJerk.bandsEnergy...17.32 + 
    fBodyAccJerk.bandsEnergy...33.48 + fBodyAccJerk.bandsEnergy...49.64 + 
    fBodyAccJerk.bandsEnergy...1.24 + fBodyAccJerk.bandsEnergy...25.48 + 
    fBodyAccJerk.bandsEnergy...1.8.1 + fBodyAccJerk.bandsEnergy...9.16.1 + 
    fBodyAccJerk.bandsEnergy...17.24.1 + fBodyAccJerk.bandsEnergy...25.32.1 + 
    fBodyAccJerk.bandsEnergy...33.40.1 + fBodyAccJerk.bandsEnergy...41.48.1 +fBodyAccJerk.bandsEnergy...49.56.1 + fBodyAccJerk.bandsEnergy...57.64.1 + 
    fBodyAccJerk.bandsEnergy...1.16.1 + fBodyAccJerk.bandsEnergy...17.32.1 + 
    fBodyAccJerk.bandsEnergy...33.48.1 + fBodyAccJerk.bandsEnergy...49.64.1 + 
    fBodyAccJerk.bandsEnergy...1.24.1 + fBodyAccJerk.bandsEnergy...25.48.1 + 
    fBodyAccJerk.bandsEnergy...1.8.2 + fBodyAccJerk.bandsEnergy...9.16.2 + 
    fBodyAccJerk.bandsEnergy...17.24.2 + fBodyAccJerk.bandsEnergy...25.32.2 + 
    fBodyAccJerk.bandsEnergy...33.40.2 + fBodyAccJerk.bandsEnergy...41.48.2 + 
    fBodyAccJerk.bandsEnergy...49.56.2 + fBodyAccJerk.bandsEnergy...57.64.2 + 
    fBodyAccJerk.bandsEnergy...1.16.2 + fBodyAccJerk.bandsEnergy...17.32.2 + 
    fBodyAccJerk.bandsEnergy...33.48.2 + fBodyAccJerk.bandsEnergy...49.64.2 + 
    fBodyAccJerk.bandsEnergy...1.24.2 + fBodyAccJerk.bandsEnergy...25.48.2 + 
    fBodyGyro.mean...X + fBodyGyro.mean...Y + fBodyGyro.mean...Z + 
    fBodyGyro.std...X + fBodyGyro.std...Y + fBodyGyro.std...Z + 
    fBodyGyro.mad...X + fBodyGyro.mad...Y + fBodyGyro.mad...Z + 
    fBodyGyro.max...X + fBodyGyro.max...Y + fBodyGyro.max...Z + 
    fBodyGyro.min...X + fBodyGyro.min...Y + fBodyGyro.min...Z + 
    fBodyGyro.sma.. + fBodyGyro.energy...X + fBodyGyro.energy...Y + 
    fBodyGyro.energy...Z + fBodyGyro.iqr...X + fBodyGyro.iqr...Y + 
    fBodyGyro.iqr...Z + fBodyGyro.entropy...X + fBodyGyro.entropy...Y + 
    fBodyGyro.entropy...Z + fBodyGyro.maxInds.X + fBodyGyro.maxInds.Y + 
    fBodyGyro.maxInds.Z + fBodyGyro.meanFreq...X + fBodyGyro.meanFreq...Y + 
    fBodyGyro.meanFreq...Z + fBodyGyro.skewness...X + fBodyGyro.kurtosis...X + 
    fBodyGyro.skewness...Y + fBodyGyro.kurtosis...Y + fBodyGyro.skewness...Z + 
    fBodyGyro.kurtosis...Z + fBodyGyro.bandsEnergy...1.8 + fBodyGyro.bandsEnergy...9.16 + 
    fBodyGyro.bandsEnergy...17.24 + fBodyGyro.bandsEnergy...25.32 + 
    fBodyGyro.bandsEnergy...33.40 + fBodyGyro.bandsEnergy...41.48 + 
    fBodyGyro.bandsEnergy...49.56 + fBodyGyro.bandsEnergy...57.64 + 
    fBodyGyro.bandsEnergy...1.16 + fBodyGyro.bandsEnergy...17.32 + 
    fBodyGyro.bandsEnergy...33.48 + fBodyGyro.bandsEnergy...49.64 + 
    fBodyGyro.bandsEnergy...1.24 + fBodyGyro.bandsEnergy...25.48 + 
    fBodyGyro.bandsEnergy...1.8.1 + fBodyGyro.bandsEnergy...9.16.1 + 
    fBodyGyro.bandsEnergy...17.24.1 + fBodyGyro.bandsEnergy...25.32.1 + 
    fBodyGyro.bandsEnergy...33.40.1 + fBodyGyro.bandsEnergy...41.48.1 + 
    fBodyGyro.bandsEnergy...49.56.1 + fBodyGyro.bandsEnergy...57.64.1 + 
    fBodyGyro.bandsEnergy...1.16.1 + fBodyGyro.bandsEnergy...17.32.1 + 
    fBodyGyro.bandsEnergy...33.48.1 + fBodyGyro.bandsEnergy...49.64.1 + 
    fBodyGyro.bandsEnergy...1.24.1 + fBodyGyro.bandsEnergy...25.48.1 + 
    fBodyGyro.bandsEnergy...1.8.2 + fBodyGyro.bandsEnergy...9.16.2 + 
    fBodyGyro.bandsEnergy...17.24.2 + fBodyGyro.bandsEnergy...25.32.2 + 
    fBodyGyro.bandsEnergy...33.40.2 + fBodyGyro.bandsEnergy...41.48.2 + 
    fBodyGyro.bandsEnergy...49.56.2 + fBodyGyro.bandsEnergy...57.64.2 + 
    fBodyGyro.bandsEnergy...1.16.2 + fBodyGyro.bandsEnergy...17.32.2 + 
    fBodyGyro.bandsEnergy...33.48.2 + fBodyGyro.bandsEnergy...49.64.2 + 
    fBodyGyro.bandsEnergy...1.24.2 + fBodyGyro.bandsEnergy...25.48.2 + 
    fBodyAccMag.mean.. + fBodyAccMag.std.. + fBodyAccMag.mad.. + 
    fBodyAccMag.max.. + fBodyAccMag.min.. + fBodyAccMag.sma.. + 
    fBodyAccMag.energy.. + fBodyAccMag.iqr.. + fBodyAccMag.entropy.. + 
    fBodyAccMag.maxInds + fBodyAccMag.meanFreq.. + fBodyAccMag.skewness.. + 
    fBodyAccMag.kurtosis.. + fBodyBodyAccJerkMag.mean.. + fBodyBodyAccJerkMag.std.. + 
    fBodyBodyAccJerkMag.mad.. + fBodyBodyAccJerkMag.max.. + fBodyBodyAccJerkMag.min.. + 
    fBodyBodyAccJerkMag.sma.. + fBodyBodyAccJerkMag.energy.. + 
    fBodyBodyAccJerkMag.iqr.. + fBodyBodyAccJerkMag.entropy.. + 
    fBodyBodyAccJerkMag.maxInds + fBodyBodyAccJerkMag.meanFreq.. + 
    fBodyBodyAccJerkMag.skewness.. + fBodyBodyAccJerkMag.kurtosis.. + fBodyBodyGyroMag.mean.. + fBodyBodyGyroMag.std.. + fBodyBodyGyroMag.mad.. + 
    fBodyBodyGyroMag.max.. + fBodyBodyGyroMag.min.. + fBodyBodyGyroMag.sma.. + 
    fBodyBodyGyroMag.energy.. + fBodyBodyGyroMag.iqr.. + fBodyBodyGyroMag.entropy.. + 
    fBodyBodyGyroMag.maxInds + fBodyBodyGyroMag.meanFreq.. + 
    fBodyBodyGyroMag.skewness.. + fBodyBodyGyroMag.kurtosis.. + 
    fBodyBodyGyroJerkMag.mean.. + fBodyBodyGyroJerkMag.std.. + 
    fBodyBodyGyroJerkMag.mad.. + fBodyBodyGyroJerkMag.max.. + 
    fBodyBodyGyroJerkMag.min.. + fBodyBodyGyroJerkMag.sma.. + 
    fBodyBodyGyroJerkMag.energy.. + fBodyBodyGyroJerkMag.iqr.. + 
    fBodyBodyGyroJerkMag.entropy.. + fBodyBodyGyroJerkMag.maxInds + 
    fBodyBodyGyroJerkMag.meanFreq.. + fBodyBodyGyroJerkMag.skewness.. + 
    fBodyBodyGyroJerkMag.kurtosis.. + angle.tBodyAccMean.gravity. + 
    angle.tBodyAccJerkMean..gravityMean. + angle.tBodyGyroMean.gravityMean. + 
    angle.tBodyGyroJerkMean.gravityMean. + angle.X.gravityMean. + 
    angle.Y.gravityMean. + angle.Z.gravityMean. + subject
  , train.data, hidden = 2, linear.output = FALSE, threshold=0.3)

```



```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
train.data3 <- train.data
training.prediction <- compute(nn6, train.data3[,1:562])
training.class <- apply(training.prediction$net.result,1,which.max)-1


revalue(train.data3$Activity, c("LAYING" = 0)) -> train.data3$Activity
revalue(train.data3$Activity, c("SITTING" = 1)) -> train.data3$Activity
revalue(train.data3$Activity, c("STANDING" = 2)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING" = 3)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> train.data3$Activity


original_values <- as.factor(train.data3$Activity)
mean(as.factor(training.class) == original_values)
confusionMatrix(as.factor(training.class), as.factor(train.data3$Activity))
table(as.factor(train.data3$Activity), training.class)


```



```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
valid.data3 <- valid.data
validation.prediction <- compute(nn6, valid.data3[,1:562])
validation.class <- apply(validation.prediction$net.result,1,which.max)-1


revalue(valid.data3$Activity, c("LAYING" = 0)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("SITTING" = 1)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("STANDING" = 2)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING" = 3)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> valid.data3$Activity


original_values_valid <- as.factor(valid.data3$Activity)
mean(as.factor(validation.class) == original_values_valid)
confusionMatrix(as.factor(validation.class), as.factor(valid.data3$Activity))
table(as.factor(valid.data3$Activity), validation.class)


```



#NN7 hidden = c(6, 3)
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
nn7 <- neuralnet((Activity == "LAYING") + (Activity == "SITTING")+ (Activity == "STANDING")+ (Activity == "WALKING") + (Activity == "WALKING_DOWNSTAIRS") + (Activity == "WALKING_UPSTAIRS") ~ tBodyAcc.mean...X + tBodyAcc.mean...Y + tBodyAcc.mean...Z + tBodyAcc.std...X + 
    tBodyAcc.std...Y + tBodyAcc.std...Z + tBodyAcc.mad...X + 
    tBodyAcc.mad...Y + tBodyAcc.mad...Z + tBodyAcc.max...X + 
    tBodyAcc.max...Y + tBodyAcc.max...Z + tBodyAcc.min...X + 
    tBodyAcc.min...Y + tBodyAcc.min...Z + tBodyAcc.sma.. + tBodyAcc.energy...X + 
    tBodyAcc.energy...Y + tBodyAcc.energy...Z + tBodyAcc.iqr...X + 
    tBodyAcc.iqr...Y + tBodyAcc.iqr...Z + tBodyAcc.entropy...X + 
    tBodyAcc.entropy...Y + tBodyAcc.entropy...Z + tBodyAcc.arCoeff...X.1 + 
    tBodyAcc.arCoeff...X.2 + tBodyAcc.arCoeff...X.3 + tBodyAcc.arCoeff...X.4 + 
    tBodyAcc.arCoeff...Y.1 + tBodyAcc.arCoeff...Y.2 + tBodyAcc.arCoeff...Y.3 + 
    tBodyAcc.arCoeff...Y.4 + tBodyAcc.arCoeff...Z.1 + tBodyAcc.arCoeff...Z.2 + 
    tBodyAcc.arCoeff...Z.3 + tBodyAcc.arCoeff...Z.4 + tBodyAcc.correlation...X.Y + 
    tBodyAcc.correlation...X.Z + tBodyAcc.correlation...Y.Z + 
    tGravityAcc.mean...X + tGravityAcc.mean...Y + tGravityAcc.mean...Z + 
    tGravityAcc.std...X + tGravityAcc.std...Y + tGravityAcc.std...Z + 
    tGravityAcc.mad...X + tGravityAcc.mad...Y + tGravityAcc.mad...Z + 
    tGravityAcc.max...X + tGravityAcc.max...Y + tGravityAcc.max...Z + 
    tGravityAcc.min...X + tGravityAcc.min...Y + tGravityAcc.min...Z + 
    tGravityAcc.sma.. + tGravityAcc.energy...X + tGravityAcc.energy...Y + 
    tGravityAcc.energy...Z + tGravityAcc.iqr...X + tGravityAcc.iqr...Y + 
    tGravityAcc.iqr...Z + tGravityAcc.entropy...X + tGravityAcc.entropy...Y + 
    tGravityAcc.entropy...Z + tGravityAcc.arCoeff...X.1 + tGravityAcc.arCoeff...X.2 + 
    tGravityAcc.arCoeff...X.3 + tGravityAcc.arCoeff...X.4 + tGravityAcc.arCoeff...Y.1 + 
    tGravityAcc.arCoeff...Y.2 + tGravityAcc.arCoeff...Y.3 + tGravityAcc.arCoeff...Y.4 + 
    tGravityAcc.arCoeff...Z.1 + tGravityAcc.arCoeff...Z.2 + tGravityAcc.arCoeff...Z.3 + 
    tGravityAcc.arCoeff...Z.4 + tGravityAcc.correlation...X.Y + 
    tGravityAcc.correlation...X.Z + tGravityAcc.correlation...Y.Z + 
    tBodyAccJerk.mean...X + tBodyAccJerk.mean...Y + tBodyAccJerk.mean...Z + 
    tBodyAccJerk.std...X + tBodyAccJerk.std...Y + tBodyAccJerk.std...Z + 
    tBodyAccJerk.mad...X + tBodyAccJerk.mad...Y + tBodyAccJerk.mad...Z + 
    tBodyAccJerk.max...X + tBodyAccJerk.max...Y + tBodyAccJerk.max...Z + 
    tBodyAccJerk.min...X + tBodyAccJerk.min...Y + tBodyAccJerk.min...Z + 
    tBodyAccJerk.sma.. + tBodyAccJerk.energy...X + tBodyAccJerk.energy...Y + 
    tBodyAccJerk.energy...Z + tBodyAccJerk.iqr...X + tBodyAccJerk.iqr...Y + 
    tBodyAccJerk.iqr...Z + tBodyAccJerk.entropy...X + tBodyAccJerk.entropy...Y + 
    tBodyAccJerk.entropy...Z + tBodyAccJerk.arCoeff...X.1 + tBodyAccJerk.arCoeff...X.2 + 
    tBodyAccJerk.arCoeff...X.3 + tBodyAccJerk.arCoeff...X.4 + 
    tBodyAccJerk.arCoeff...Y.1 + tBodyAccJerk.arCoeff...Y.2 + 
    tBodyAccJerk.arCoeff...Y.3 + tBodyAccJerk.arCoeff...Y.4 + tBodyAccJerk.arCoeff...Z.1 + tBodyAccJerk.arCoeff...Z.2 + 
    tBodyAccJerk.arCoeff...Z.3 + tBodyAccJerk.arCoeff...Z.4 + 
    tBodyAccJerk.correlation...X.Y + tBodyAccJerk.correlation...X.Z + 
    tBodyAccJerk.correlation...Y.Z + tBodyGyro.mean...X + tBodyGyro.mean...Y + 
    tBodyGyro.mean...Z + tBodyGyro.std...X + tBodyGyro.std...Y + 
    tBodyGyro.std...Z + tBodyGyro.mad...X + tBodyGyro.mad...Y + 
    tBodyGyro.mad...Z + tBodyGyro.max...X + tBodyGyro.max...Y + 
    tBodyGyro.max...Z + tBodyGyro.min...X + tBodyGyro.min...Y + 
    tBodyGyro.min...Z + tBodyGyro.sma.. + tBodyGyro.energy...X + 
    tBodyGyro.energy...Y + tBodyGyro.energy...Z + tBodyGyro.iqr...X + 
    tBodyGyro.iqr...Y + tBodyGyro.iqr...Z + tBodyGyro.entropy...X + 
    tBodyGyro.entropy...Y + tBodyGyro.entropy...Z + tBodyGyro.arCoeff...X.1 + 
    tBodyGyro.arCoeff...X.2 + tBodyGyro.arCoeff...X.3 + tBodyGyro.arCoeff...X.4 + 
    tBodyGyro.arCoeff...Y.1 + tBodyGyro.arCoeff...Y.2 + tBodyGyro.arCoeff...Y.3 + 
    tBodyGyro.arCoeff...Y.4 + tBodyGyro.arCoeff...Z.1 + tBodyGyro.arCoeff...Z.2 + 
    tBodyGyro.arCoeff...Z.3 + tBodyGyro.arCoeff...Z.4 + tBodyGyro.correlation...X.Y + 
    tBodyGyro.correlation...X.Z + tBodyGyro.correlation...Y.Z + 
    tBodyGyroJerk.mean...X + tBodyGyroJerk.mean...Y + tBodyGyroJerk.mean...Z + 
    tBodyGyroJerk.std...X + tBodyGyroJerk.std...Y + tBodyGyroJerk.std...Z + 
    tBodyGyroJerk.mad...X + tBodyGyroJerk.mad...Y + tBodyGyroJerk.mad...Z + 
    tBodyGyroJerk.max...X + tBodyGyroJerk.max...Y + tBodyGyroJerk.max...Z + 
    tBodyGyroJerk.min...X + tBodyGyroJerk.min...Y + tBodyGyroJerk.min...Z + 
    tBodyGyroJerk.sma.. + tBodyGyroJerk.energy...X + tBodyGyroJerk.energy...Y + 
    tBodyGyroJerk.energy...Z + tBodyGyroJerk.iqr...X + tBodyGyroJerk.iqr...Y + 
    tBodyGyroJerk.iqr...Z + tBodyGyroJerk.entropy...X + tBodyGyroJerk.entropy...Y + 
    tBodyGyroJerk.entropy...Z + tBodyGyroJerk.arCoeff...X.1 + 
    tBodyGyroJerk.arCoeff...X.2 + tBodyGyroJerk.arCoeff...X.3 + 
    tBodyGyroJerk.arCoeff...X.4 + tBodyGyroJerk.arCoeff...Y.1 + 
    tBodyGyroJerk.arCoeff...Y.2 + tBodyGyroJerk.arCoeff...Y.3 + 
    tBodyGyroJerk.arCoeff...Y.4 + tBodyGyroJerk.arCoeff...Z.1 + 
    tBodyGyroJerk.arCoeff...Z.2 + tBodyGyroJerk.arCoeff...Z.3 + 
    tBodyGyroJerk.arCoeff...Z.4 + tBodyGyroJerk.correlation...X.Y + 
    tBodyGyroJerk.correlation...X.Z + tBodyGyroJerk.correlation...Y.Z + 
    tBodyAccMag.mean.. + tBodyAccMag.std.. + tBodyAccMag.mad.. + 
    tBodyAccMag.max.. + tBodyAccMag.min.. + tBodyAccMag.sma.. + 
    tBodyAccMag.energy.. + tBodyAccMag.iqr.. + tBodyAccMag.entropy.. + 
    tBodyAccMag.arCoeff..1 + tBodyAccMag.arCoeff..2 + tBodyAccMag.arCoeff..3 + 
    tBodyAccMag.arCoeff..4 + tGravityAccMag.mean.. + tGravityAccMag.std.. + 
    tGravityAccMag.mad.. + tGravityAccMag.max.. + tGravityAccMag.min.. + 
    tGravityAccMag.sma.. + tGravityAccMag.energy.. + tGravityAccMag.iqr.. + 
    tGravityAccMag.entropy.. + tGravityAccMag.arCoeff..1 + tGravityAccMag.arCoeff..2 + 
    tGravityAccMag.arCoeff..3 + tGravityAccMag.arCoeff..4 + tBodyAccJerkMag.mean.. + 
    tBodyAccJerkMag.std.. + tBodyAccJerkMag.mad.. + tBodyAccJerkMag.max.. + 
    tBodyAccJerkMag.min.. + tBodyAccJerkMag.sma.. + tBodyAccJerkMag.energy.. + 
    tBodyAccJerkMag.iqr.. + tBodyAccJerkMag.entropy.. + tBodyAccJerkMag.arCoeff..1 + 
    tBodyAccJerkMag.arCoeff..2 + tBodyAccJerkMag.arCoeff..3 + 
    tBodyAccJerkMag.arCoeff..4 + tBodyGyroMag.mean.. + tBodyGyroMag.std.. + 
    tBodyGyroMag.mad.. + tBodyGyroMag.max.. + tBodyGyroMag.min.. + 
    tBodyGyroMag.sma.. + tBodyGyroMag.energy.. + tBodyGyroMag.iqr.. + 
    tBodyGyroMag.entropy.. + tBodyGyroMag.arCoeff..1 + tBodyGyroMag.arCoeff..2 + 
    tBodyGyroMag.arCoeff..3 + tBodyGyroMag.arCoeff..4 + tBodyGyroJerkMag.mean.. + 
    tBodyGyroJerkMag.std.. + tBodyGyroJerkMag.mad.. + tBodyGyroJerkMag.max.. + 
    tBodyGyroJerkMag.min.. + tBodyGyroJerkMag.sma.. + tBodyGyroJerkMag.energy.. + 
    tBodyGyroJerkMag.iqr.. + tBodyGyroJerkMag.entropy.. + tBodyGyroJerkMag.arCoeff..1 + 
    tBodyGyroJerkMag.arCoeff..2 + tBodyGyroJerkMag.arCoeff..3 +tBodyGyroJerkMag.arCoeff..4 + fBodyAcc.mean...X + fBodyAcc.mean...Y + 
    fBodyAcc.mean...Z + fBodyAcc.std...X + fBodyAcc.std...Y + 
    fBodyAcc.std...Z + fBodyAcc.mad...X + fBodyAcc.mad...Y + 
    fBodyAcc.mad...Z + fBodyAcc.max...X + fBodyAcc.max...Y + 
    fBodyAcc.max...Z + fBodyAcc.min...X + fBodyAcc.min...Y + 
    fBodyAcc.min...Z + fBodyAcc.sma.. + fBodyAcc.energy...X + 
    fBodyAcc.energy...Y + fBodyAcc.energy...Z + fBodyAcc.iqr...X + 
    fBodyAcc.iqr...Y + fBodyAcc.iqr...Z + fBodyAcc.entropy...X + 
    fBodyAcc.entropy...Y + fBodyAcc.entropy...Z + fBodyAcc.maxInds.X + 
    fBodyAcc.maxInds.Y + fBodyAcc.maxInds.Z + fBodyAcc.meanFreq...X + 
    fBodyAcc.meanFreq...Y + fBodyAcc.meanFreq...Z + fBodyAcc.skewness...X + 
    fBodyAcc.kurtosis...X + fBodyAcc.skewness...Y + fBodyAcc.kurtosis...Y + 
    fBodyAcc.skewness...Z + fBodyAcc.kurtosis...Z + fBodyAcc.bandsEnergy...1.8 + 
    fBodyAcc.bandsEnergy...9.16 + fBodyAcc.bandsEnergy...17.24 + 
    fBodyAcc.bandsEnergy...25.32 + fBodyAcc.bandsEnergy...33.40 + 
    fBodyAcc.bandsEnergy...41.48 + fBodyAcc.bandsEnergy...49.56 + 
    fBodyAcc.bandsEnergy...57.64 + fBodyAcc.bandsEnergy...1.16 + 
    fBodyAcc.bandsEnergy...17.32 + fBodyAcc.bandsEnergy...33.48 + 
    fBodyAcc.bandsEnergy...49.64 + fBodyAcc.bandsEnergy...1.24 + 
    fBodyAcc.bandsEnergy...25.48 + fBodyAcc.bandsEnergy...1.8.1 + 
    fBodyAcc.bandsEnergy...9.16.1 + fBodyAcc.bandsEnergy...17.24.1 + 
    fBodyAcc.bandsEnergy...25.32.1 + fBodyAcc.bandsEnergy...33.40.1 + 
    fBodyAcc.bandsEnergy...41.48.1 + fBodyAcc.bandsEnergy...49.56.1 + 
    fBodyAcc.bandsEnergy...57.64.1 + fBodyAcc.bandsEnergy...1.16.1 + 
    fBodyAcc.bandsEnergy...17.32.1 + fBodyAcc.bandsEnergy...33.48.1 + 
    fBodyAcc.bandsEnergy...49.64.1 + fBodyAcc.bandsEnergy...1.24.1 + 
    fBodyAcc.bandsEnergy...25.48.1 + fBodyAcc.bandsEnergy...1.8.2 + 
    fBodyAcc.bandsEnergy...9.16.2 + fBodyAcc.bandsEnergy...17.24.2 + 
    fBodyAcc.bandsEnergy...25.32.2 + fBodyAcc.bandsEnergy...33.40.2 + 
    fBodyAcc.bandsEnergy...41.48.2 + fBodyAcc.bandsEnergy...49.56.2 + 
    fBodyAcc.bandsEnergy...57.64.2 + fBodyAcc.bandsEnergy...1.16.2 + 
    fBodyAcc.bandsEnergy...17.32.2 + fBodyAcc.bandsEnergy...33.48.2 + 
    fBodyAcc.bandsEnergy...49.64.2 + fBodyAcc.bandsEnergy...1.24.2 + 
    fBodyAcc.bandsEnergy...25.48.2 + fBodyAccJerk.mean...X + 
    fBodyAccJerk.mean...Y + fBodyAccJerk.mean...Z + fBodyAccJerk.std...X + 
    fBodyAccJerk.std...Y + fBodyAccJerk.std...Z + fBodyAccJerk.mad...X + 
    fBodyAccJerk.mad...Y + fBodyAccJerk.mad...Z + fBodyAccJerk.max...X + 
    fBodyAccJerk.max...Y + fBodyAccJerk.max...Z + fBodyAccJerk.min...X + 
    fBodyAccJerk.min...Y + fBodyAccJerk.min...Z + fBodyAccJerk.sma.. + 
    fBodyAccJerk.energy...X + fBodyAccJerk.energy...Y + fBodyAccJerk.energy...Z + 
    fBodyAccJerk.iqr...X + fBodyAccJerk.iqr...Y + fBodyAccJerk.iqr...Z + 
    fBodyAccJerk.entropy...X + fBodyAccJerk.entropy...Y + fBodyAccJerk.entropy...Z + 
    fBodyAccJerk.maxInds.X + fBodyAccJerk.maxInds.Y + fBodyAccJerk.maxInds.Z + 
    fBodyAccJerk.meanFreq...X + fBodyAccJerk.meanFreq...Y + fBodyAccJerk.meanFreq...Z + 
    fBodyAccJerk.skewness...X + fBodyAccJerk.kurtosis...X + fBodyAccJerk.skewness...Y + 
    fBodyAccJerk.kurtosis...Y + fBodyAccJerk.skewness...Z + fBodyAccJerk.kurtosis...Z + 
    fBodyAccJerk.bandsEnergy...1.8 + fBodyAccJerk.bandsEnergy...9.16 + 
    fBodyAccJerk.bandsEnergy...17.24 + fBodyAccJerk.bandsEnergy...25.32 + 
    fBodyAccJerk.bandsEnergy...33.40 + fBodyAccJerk.bandsEnergy...41.48 + 
    fBodyAccJerk.bandsEnergy...49.56 + fBodyAccJerk.bandsEnergy...57.64 + 
    fBodyAccJerk.bandsEnergy...1.16 + fBodyAccJerk.bandsEnergy...17.32 + 
    fBodyAccJerk.bandsEnergy...33.48 + fBodyAccJerk.bandsEnergy...49.64 + 
    fBodyAccJerk.bandsEnergy...1.24 + fBodyAccJerk.bandsEnergy...25.48 + 
    fBodyAccJerk.bandsEnergy...1.8.1 + fBodyAccJerk.bandsEnergy...9.16.1 + 
    fBodyAccJerk.bandsEnergy...17.24.1 + fBodyAccJerk.bandsEnergy...25.32.1 + 
    fBodyAccJerk.bandsEnergy...33.40.1 + fBodyAccJerk.bandsEnergy...41.48.1 +fBodyAccJerk.bandsEnergy...49.56.1 + fBodyAccJerk.bandsEnergy...57.64.1 + 
    fBodyAccJerk.bandsEnergy...1.16.1 + fBodyAccJerk.bandsEnergy...17.32.1 + 
    fBodyAccJerk.bandsEnergy...33.48.1 + fBodyAccJerk.bandsEnergy...49.64.1 + 
    fBodyAccJerk.bandsEnergy...1.24.1 + fBodyAccJerk.bandsEnergy...25.48.1 + 
    fBodyAccJerk.bandsEnergy...1.8.2 + fBodyAccJerk.bandsEnergy...9.16.2 + 
    fBodyAccJerk.bandsEnergy...17.24.2 + fBodyAccJerk.bandsEnergy...25.32.2 + 
    fBodyAccJerk.bandsEnergy...33.40.2 + fBodyAccJerk.bandsEnergy...41.48.2 + 
    fBodyAccJerk.bandsEnergy...49.56.2 + fBodyAccJerk.bandsEnergy...57.64.2 + 
    fBodyAccJerk.bandsEnergy...1.16.2 + fBodyAccJerk.bandsEnergy...17.32.2 + 
    fBodyAccJerk.bandsEnergy...33.48.2 + fBodyAccJerk.bandsEnergy...49.64.2 + 
    fBodyAccJerk.bandsEnergy...1.24.2 + fBodyAccJerk.bandsEnergy...25.48.2 + 
    fBodyGyro.mean...X + fBodyGyro.mean...Y + fBodyGyro.mean...Z + 
    fBodyGyro.std...X + fBodyGyro.std...Y + fBodyGyro.std...Z + 
    fBodyGyro.mad...X + fBodyGyro.mad...Y + fBodyGyro.mad...Z + 
    fBodyGyro.max...X + fBodyGyro.max...Y + fBodyGyro.max...Z + 
    fBodyGyro.min...X + fBodyGyro.min...Y + fBodyGyro.min...Z + 
    fBodyGyro.sma.. + fBodyGyro.energy...X + fBodyGyro.energy...Y + 
    fBodyGyro.energy...Z + fBodyGyro.iqr...X + fBodyGyro.iqr...Y + 
    fBodyGyro.iqr...Z + fBodyGyro.entropy...X + fBodyGyro.entropy...Y + 
    fBodyGyro.entropy...Z + fBodyGyro.maxInds.X + fBodyGyro.maxInds.Y + 
    fBodyGyro.maxInds.Z + fBodyGyro.meanFreq...X + fBodyGyro.meanFreq...Y + 
    fBodyGyro.meanFreq...Z + fBodyGyro.skewness...X + fBodyGyro.kurtosis...X + 
    fBodyGyro.skewness...Y + fBodyGyro.kurtosis...Y + fBodyGyro.skewness...Z + 
    fBodyGyro.kurtosis...Z + fBodyGyro.bandsEnergy...1.8 + fBodyGyro.bandsEnergy...9.16 + 
    fBodyGyro.bandsEnergy...17.24 + fBodyGyro.bandsEnergy...25.32 + 
    fBodyGyro.bandsEnergy...33.40 + fBodyGyro.bandsEnergy...41.48 + 
    fBodyGyro.bandsEnergy...49.56 + fBodyGyro.bandsEnergy...57.64 + 
    fBodyGyro.bandsEnergy...1.16 + fBodyGyro.bandsEnergy...17.32 + 
    fBodyGyro.bandsEnergy...33.48 + fBodyGyro.bandsEnergy...49.64 + 
    fBodyGyro.bandsEnergy...1.24 + fBodyGyro.bandsEnergy...25.48 + 
    fBodyGyro.bandsEnergy...1.8.1 + fBodyGyro.bandsEnergy...9.16.1 + 
    fBodyGyro.bandsEnergy...17.24.1 + fBodyGyro.bandsEnergy...25.32.1 + 
    fBodyGyro.bandsEnergy...33.40.1 + fBodyGyro.bandsEnergy...41.48.1 + 
    fBodyGyro.bandsEnergy...49.56.1 + fBodyGyro.bandsEnergy...57.64.1 + 
    fBodyGyro.bandsEnergy...1.16.1 + fBodyGyro.bandsEnergy...17.32.1 + 
    fBodyGyro.bandsEnergy...33.48.1 + fBodyGyro.bandsEnergy...49.64.1 + 
    fBodyGyro.bandsEnergy...1.24.1 + fBodyGyro.bandsEnergy...25.48.1 + 
    fBodyGyro.bandsEnergy...1.8.2 + fBodyGyro.bandsEnergy...9.16.2 + 
    fBodyGyro.bandsEnergy...17.24.2 + fBodyGyro.bandsEnergy...25.32.2 + 
    fBodyGyro.bandsEnergy...33.40.2 + fBodyGyro.bandsEnergy...41.48.2 + 
    fBodyGyro.bandsEnergy...49.56.2 + fBodyGyro.bandsEnergy...57.64.2 + 
    fBodyGyro.bandsEnergy...1.16.2 + fBodyGyro.bandsEnergy...17.32.2 + 
    fBodyGyro.bandsEnergy...33.48.2 + fBodyGyro.bandsEnergy...49.64.2 + 
    fBodyGyro.bandsEnergy...1.24.2 + fBodyGyro.bandsEnergy...25.48.2 + 
    fBodyAccMag.mean.. + fBodyAccMag.std.. + fBodyAccMag.mad.. + 
    fBodyAccMag.max.. + fBodyAccMag.min.. + fBodyAccMag.sma.. + 
    fBodyAccMag.energy.. + fBodyAccMag.iqr.. + fBodyAccMag.entropy.. + 
    fBodyAccMag.maxInds + fBodyAccMag.meanFreq.. + fBodyAccMag.skewness.. + 
    fBodyAccMag.kurtosis.. + fBodyBodyAccJerkMag.mean.. + fBodyBodyAccJerkMag.std.. + 
    fBodyBodyAccJerkMag.mad.. + fBodyBodyAccJerkMag.max.. + fBodyBodyAccJerkMag.min.. + 
    fBodyBodyAccJerkMag.sma.. + fBodyBodyAccJerkMag.energy.. + 
    fBodyBodyAccJerkMag.iqr.. + fBodyBodyAccJerkMag.entropy.. + 
    fBodyBodyAccJerkMag.maxInds + fBodyBodyAccJerkMag.meanFreq.. + 
    fBodyBodyAccJerkMag.skewness.. + fBodyBodyAccJerkMag.kurtosis.. + fBodyBodyGyroMag.mean.. + fBodyBodyGyroMag.std.. + fBodyBodyGyroMag.mad.. + 
    fBodyBodyGyroMag.max.. + fBodyBodyGyroMag.min.. + fBodyBodyGyroMag.sma.. + 
    fBodyBodyGyroMag.energy.. + fBodyBodyGyroMag.iqr.. + fBodyBodyGyroMag.entropy.. + 
    fBodyBodyGyroMag.maxInds + fBodyBodyGyroMag.meanFreq.. + 
    fBodyBodyGyroMag.skewness.. + fBodyBodyGyroMag.kurtosis.. + 
    fBodyBodyGyroJerkMag.mean.. + fBodyBodyGyroJerkMag.std.. + 
    fBodyBodyGyroJerkMag.mad.. + fBodyBodyGyroJerkMag.max.. + 
    fBodyBodyGyroJerkMag.min.. + fBodyBodyGyroJerkMag.sma.. + 
    fBodyBodyGyroJerkMag.energy.. + fBodyBodyGyroJerkMag.iqr.. + 
    fBodyBodyGyroJerkMag.entropy.. + fBodyBodyGyroJerkMag.maxInds + 
    fBodyBodyGyroJerkMag.meanFreq.. + fBodyBodyGyroJerkMag.skewness.. + 
    fBodyBodyGyroJerkMag.kurtosis.. + angle.tBodyAccMean.gravity. + 
    angle.tBodyAccJerkMean..gravityMean. + angle.tBodyGyroMean.gravityMean. + 
    angle.tBodyGyroJerkMean.gravityMean. + angle.X.gravityMean. + 
    angle.Y.gravityMean. + angle.Z.gravityMean. + subject
  , train.data,  hidden = c(6, 3), linear.output = FALSE, threshold=0.3)

```

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
train.data3 <- train.data
training.prediction <- compute(nn7, train.data3[,1:562])
training.class <- apply(training.prediction$net.result,1,which.max)-1


revalue(train.data3$Activity, c("LAYING" = 0)) -> train.data3$Activity
revalue(train.data3$Activity, c("SITTING" = 1)) -> train.data3$Activity
revalue(train.data3$Activity, c("STANDING" = 2)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING" = 3)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> train.data3$Activity


original_values <- as.factor(train.data3$Activity)
mean(as.factor(training.class) == original_values)
confusionMatrix(as.factor(training.class), as.factor(train.data3$Activity))
table(as.factor(train.data3$Activity), training.class)


```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (testing set)
valid.data3 <- valid.data
validation.prediction <- compute(nn7, valid.data3[,1:562])
validation.class <- apply(validation.prediction$net.result,1,which.max)-1


revalue(valid.data3$Activity, c("LAYING" = 0)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("SITTING" = 1)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("STANDING" = 2)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING" = 3)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> valid.data3$Activity


original_values_valid <- as.factor(valid.data3$Activity)
mean(as.factor(validation.class) == original_values_valid)
confusionMatrix(as.factor(validation.class), as.factor(valid.data3$Activity))
table(as.factor(valid.data3$Activity), validation.class)


```





# NN87 hidden = 6
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
n87 <- neuralnet((Activity == "LAYING") + (Activity == "SITTING")+ (Activity == "STANDING")+ (Activity == "WALKING") + (Activity == "WALKING_DOWNSTAIRS") + (Activity == "WALKING_UPSTAIRS") ~ tBodyAcc.mean...X + tBodyAcc.mean...Y + tBodyAcc.mean...Z + tBodyAcc.std...X + 
    tBodyAcc.std...Y + tBodyAcc.std...Z + tBodyAcc.mad...X + 
    tBodyAcc.mad...Y + tBodyAcc.mad...Z + tBodyAcc.max...X + 
    tBodyAcc.max...Y + tBodyAcc.max...Z + tBodyAcc.min...X + 
    tBodyAcc.min...Y + tBodyAcc.min...Z + tBodyAcc.sma.. + tBodyAcc.energy...X + 
    tBodyAcc.energy...Y + tBodyAcc.energy...Z + tBodyAcc.iqr...X + 
    tBodyAcc.iqr...Y + tBodyAcc.iqr...Z + tBodyAcc.entropy...X + 
    tBodyAcc.entropy...Y + tBodyAcc.entropy...Z + tBodyAcc.arCoeff...X.1 + 
    tBodyAcc.arCoeff...X.2 + tBodyAcc.arCoeff...X.3 + tBodyAcc.arCoeff...X.4 + 
    tBodyAcc.arCoeff...Y.1 + tBodyAcc.arCoeff...Y.2 + tBodyAcc.arCoeff...Y.3 + 
    tBodyAcc.arCoeff...Y.4 + tBodyAcc.arCoeff...Z.1 + tBodyAcc.arCoeff...Z.2 + 
    tBodyAcc.arCoeff...Z.3 + tBodyAcc.arCoeff...Z.4 + tBodyAcc.correlation...X.Y + 
    tBodyAcc.correlation...X.Z + tBodyAcc.correlation...Y.Z + 
    tGravityAcc.mean...X + tGravityAcc.mean...Y + tGravityAcc.mean...Z + 
    tGravityAcc.std...X + tGravityAcc.std...Y + tGravityAcc.std...Z + 
    tGravityAcc.mad...X + tGravityAcc.mad...Y + tGravityAcc.mad...Z + 
    tGravityAcc.max...X + tGravityAcc.max...Y + tGravityAcc.max...Z + 
    tGravityAcc.min...X + tGravityAcc.min...Y + tGravityAcc.min...Z + 
    tGravityAcc.sma.. + tGravityAcc.energy...X + tGravityAcc.energy...Y + 
    tGravityAcc.energy...Z + tGravityAcc.iqr...X + tGravityAcc.iqr...Y + 
    tGravityAcc.iqr...Z + tGravityAcc.entropy...X + tGravityAcc.entropy...Y + 
    tGravityAcc.entropy...Z + tGravityAcc.arCoeff...X.1 + tGravityAcc.arCoeff...X.2 + 
    tGravityAcc.arCoeff...X.3 + tGravityAcc.arCoeff...X.4 + tGravityAcc.arCoeff...Y.1 + 
    tGravityAcc.arCoeff...Y.2 + tGravityAcc.arCoeff...Y.3 + tGravityAcc.arCoeff...Y.4 + 
    tGravityAcc.arCoeff...Z.1 + tGravityAcc.arCoeff...Z.2 + tGravityAcc.arCoeff...Z.3 + 
    tGravityAcc.arCoeff...Z.4 + tGravityAcc.correlation...X.Y + 
    tGravityAcc.correlation...X.Z + tGravityAcc.correlation...Y.Z + 
    tBodyAccJerk.mean...X + tBodyAccJerk.mean...Y + tBodyAccJerk.mean...Z + 
    tBodyAccJerk.std...X + tBodyAccJerk.std...Y + tBodyAccJerk.std...Z + 
    tBodyAccJerk.mad...X + tBodyAccJerk.mad...Y + tBodyAccJerk.mad...Z + 
    tBodyAccJerk.max...X + tBodyAccJerk.max...Y + tBodyAccJerk.max...Z + 
    tBodyAccJerk.min...X + tBodyAccJerk.min...Y + tBodyAccJerk.min...Z + 
    tBodyAccJerk.sma.. + tBodyAccJerk.energy...X + tBodyAccJerk.energy...Y + 
    tBodyAccJerk.energy...Z + tBodyAccJerk.iqr...X + tBodyAccJerk.iqr...Y + 
    tBodyAccJerk.iqr...Z + tBodyAccJerk.entropy...X + tBodyAccJerk.entropy...Y + 
    tBodyAccJerk.entropy...Z + tBodyAccJerk.arCoeff...X.1 + tBodyAccJerk.arCoeff...X.2 + 
    tBodyAccJerk.arCoeff...X.3 + tBodyAccJerk.arCoeff...X.4 + 
    tBodyAccJerk.arCoeff...Y.1 + tBodyAccJerk.arCoeff...Y.2 + 
    tBodyAccJerk.arCoeff...Y.3 + tBodyAccJerk.arCoeff...Y.4 + tBodyAccJerk.arCoeff...Z.1 + tBodyAccJerk.arCoeff...Z.2 + 
    tBodyAccJerk.arCoeff...Z.3 + tBodyAccJerk.arCoeff...Z.4 + 
    tBodyAccJerk.correlation...X.Y + tBodyAccJerk.correlation...X.Z + 
    tBodyAccJerk.correlation...Y.Z + tBodyGyro.mean...X + tBodyGyro.mean...Y + 
    tBodyGyro.mean...Z + tBodyGyro.std...X + tBodyGyro.std...Y + 
    tBodyGyro.std...Z + tBodyGyro.mad...X + tBodyGyro.mad...Y + 
    tBodyGyro.mad...Z + tBodyGyro.max...X + tBodyGyro.max...Y + 
    tBodyGyro.max...Z + tBodyGyro.min...X + tBodyGyro.min...Y + 
    tBodyGyro.min...Z + tBodyGyro.sma.. + tBodyGyro.energy...X + 
    tBodyGyro.energy...Y + tBodyGyro.energy...Z + tBodyGyro.iqr...X + 
    tBodyGyro.iqr...Y + tBodyGyro.iqr...Z + tBodyGyro.entropy...X + 
    tBodyGyro.entropy...Y + tBodyGyro.entropy...Z + tBodyGyro.arCoeff...X.1 + 
    tBodyGyro.arCoeff...X.2 + tBodyGyro.arCoeff...X.3 + tBodyGyro.arCoeff...X.4 + 
    tBodyGyro.arCoeff...Y.1 + tBodyGyro.arCoeff...Y.2 + tBodyGyro.arCoeff...Y.3 + 
    tBodyGyro.arCoeff...Y.4 + tBodyGyro.arCoeff...Z.1 + tBodyGyro.arCoeff...Z.2 + 
    tBodyGyro.arCoeff...Z.3 + tBodyGyro.arCoeff...Z.4 + tBodyGyro.correlation...X.Y + 
    tBodyGyro.correlation...X.Z + tBodyGyro.correlation...Y.Z + 
    tBodyGyroJerk.mean...X + tBodyGyroJerk.mean...Y + tBodyGyroJerk.mean...Z + 
    tBodyGyroJerk.std...X + tBodyGyroJerk.std...Y + tBodyGyroJerk.std...Z + 
    tBodyGyroJerk.mad...X + tBodyGyroJerk.mad...Y + tBodyGyroJerk.mad...Z + 
    tBodyGyroJerk.max...X + tBodyGyroJerk.max...Y + tBodyGyroJerk.max...Z + 
    tBodyGyroJerk.min...X + tBodyGyroJerk.min...Y + tBodyGyroJerk.min...Z + 
    tBodyGyroJerk.sma.. + tBodyGyroJerk.energy...X + tBodyGyroJerk.energy...Y + 
    tBodyGyroJerk.energy...Z + tBodyGyroJerk.iqr...X + tBodyGyroJerk.iqr...Y + 
    tBodyGyroJerk.iqr...Z + tBodyGyroJerk.entropy...X + tBodyGyroJerk.entropy...Y + 
    tBodyGyroJerk.entropy...Z + tBodyGyroJerk.arCoeff...X.1 + 
    tBodyGyroJerk.arCoeff...X.2 + tBodyGyroJerk.arCoeff...X.3 + 
    tBodyGyroJerk.arCoeff...X.4 + tBodyGyroJerk.arCoeff...Y.1 + 
    tBodyGyroJerk.arCoeff...Y.2 + tBodyGyroJerk.arCoeff...Y.3 + 
    tBodyGyroJerk.arCoeff...Y.4 + tBodyGyroJerk.arCoeff...Z.1 + 
    tBodyGyroJerk.arCoeff...Z.2 + tBodyGyroJerk.arCoeff...Z.3 + 
    tBodyGyroJerk.arCoeff...Z.4 + tBodyGyroJerk.correlation...X.Y + 
    tBodyGyroJerk.correlation...X.Z + tBodyGyroJerk.correlation...Y.Z + 
    tBodyAccMag.mean.. + tBodyAccMag.std.. + tBodyAccMag.mad.. + 
    tBodyAccMag.max.. + tBodyAccMag.min.. + tBodyAccMag.sma.. + 
    tBodyAccMag.energy.. + tBodyAccMag.iqr.. + tBodyAccMag.entropy.. + 
    tBodyAccMag.arCoeff..1 + tBodyAccMag.arCoeff..2 + tBodyAccMag.arCoeff..3 + 
    tBodyAccMag.arCoeff..4 + tGravityAccMag.mean.. + tGravityAccMag.std.. + 
    tGravityAccMag.mad.. + tGravityAccMag.max.. + tGravityAccMag.min.. + 
    tGravityAccMag.sma.. + tGravityAccMag.energy.. + tGravityAccMag.iqr.. + 
    tGravityAccMag.entropy.. + tGravityAccMag.arCoeff..1 + tGravityAccMag.arCoeff..2 + 
    tGravityAccMag.arCoeff..3 + tGravityAccMag.arCoeff..4 + tBodyAccJerkMag.mean.. + 
    tBodyAccJerkMag.std.. + tBodyAccJerkMag.mad.. + tBodyAccJerkMag.max.. + 
    tBodyAccJerkMag.min.. + tBodyAccJerkMag.sma.. + tBodyAccJerkMag.energy.. + 
    tBodyAccJerkMag.iqr.. + tBodyAccJerkMag.entropy.. + tBodyAccJerkMag.arCoeff..1 + 
    tBodyAccJerkMag.arCoeff..2 + tBodyAccJerkMag.arCoeff..3 + 
    tBodyAccJerkMag.arCoeff..4 + tBodyGyroMag.mean.. + tBodyGyroMag.std.. + 
    tBodyGyroMag.mad.. + tBodyGyroMag.max.. + tBodyGyroMag.min.. + 
    tBodyGyroMag.sma.. + tBodyGyroMag.energy.. + tBodyGyroMag.iqr.. + 
    tBodyGyroMag.entropy.. + tBodyGyroMag.arCoeff..1 + tBodyGyroMag.arCoeff..2 + 
    tBodyGyroMag.arCoeff..3 + tBodyGyroMag.arCoeff..4 + tBodyGyroJerkMag.mean.. + 
    tBodyGyroJerkMag.std.. + tBodyGyroJerkMag.mad.. + tBodyGyroJerkMag.max.. + 
    tBodyGyroJerkMag.min.. + tBodyGyroJerkMag.sma.. + tBodyGyroJerkMag.energy.. + 
    tBodyGyroJerkMag.iqr.. + tBodyGyroJerkMag.entropy.. + tBodyGyroJerkMag.arCoeff..1 + 
    tBodyGyroJerkMag.arCoeff..2 + tBodyGyroJerkMag.arCoeff..3 +tBodyGyroJerkMag.arCoeff..4 + fBodyAcc.mean...X + fBodyAcc.mean...Y + 
    fBodyAcc.mean...Z + fBodyAcc.std...X + fBodyAcc.std...Y + 
    fBodyAcc.std...Z + fBodyAcc.mad...X + fBodyAcc.mad...Y + 
    fBodyAcc.mad...Z + fBodyAcc.max...X + fBodyAcc.max...Y + 
    fBodyAcc.max...Z + fBodyAcc.min...X + fBodyAcc.min...Y + 
    fBodyAcc.min...Z + fBodyAcc.sma.. + fBodyAcc.energy...X + 
    fBodyAcc.energy...Y + fBodyAcc.energy...Z + fBodyAcc.iqr...X + 
    fBodyAcc.iqr...Y + fBodyAcc.iqr...Z + fBodyAcc.entropy...X + 
    fBodyAcc.entropy...Y + fBodyAcc.entropy...Z + fBodyAcc.maxInds.X + 
    fBodyAcc.maxInds.Y + fBodyAcc.maxInds.Z + fBodyAcc.meanFreq...X + 
    fBodyAcc.meanFreq...Y + fBodyAcc.meanFreq...Z + fBodyAcc.skewness...X + 
    fBodyAcc.kurtosis...X + fBodyAcc.skewness...Y + fBodyAcc.kurtosis...Y + 
    fBodyAcc.skewness...Z + fBodyAcc.kurtosis...Z + fBodyAcc.bandsEnergy...1.8 + 
    fBodyAcc.bandsEnergy...9.16 + fBodyAcc.bandsEnergy...17.24 + 
    fBodyAcc.bandsEnergy...25.32 + fBodyAcc.bandsEnergy...33.40 + 
    fBodyAcc.bandsEnergy...41.48 + fBodyAcc.bandsEnergy...49.56 + 
    fBodyAcc.bandsEnergy...57.64 + fBodyAcc.bandsEnergy...1.16 + 
    fBodyAcc.bandsEnergy...17.32 + fBodyAcc.bandsEnergy...33.48 + 
    fBodyAcc.bandsEnergy...49.64 + fBodyAcc.bandsEnergy...1.24 + 
    fBodyAcc.bandsEnergy...25.48 + fBodyAcc.bandsEnergy...1.8.1 + 
    fBodyAcc.bandsEnergy...9.16.1 + fBodyAcc.bandsEnergy...17.24.1 + 
    fBodyAcc.bandsEnergy...25.32.1 + fBodyAcc.bandsEnergy...33.40.1 + 
    fBodyAcc.bandsEnergy...41.48.1 + fBodyAcc.bandsEnergy...49.56.1 + 
    fBodyAcc.bandsEnergy...57.64.1 + fBodyAcc.bandsEnergy...1.16.1 + 
    fBodyAcc.bandsEnergy...17.32.1 + fBodyAcc.bandsEnergy...33.48.1 + 
    fBodyAcc.bandsEnergy...49.64.1 + fBodyAcc.bandsEnergy...1.24.1 + 
    fBodyAcc.bandsEnergy...25.48.1 + fBodyAcc.bandsEnergy...1.8.2 + 
    fBodyAcc.bandsEnergy...9.16.2 + fBodyAcc.bandsEnergy...17.24.2 + 
    fBodyAcc.bandsEnergy...25.32.2 + fBodyAcc.bandsEnergy...33.40.2 + 
    fBodyAcc.bandsEnergy...41.48.2 + fBodyAcc.bandsEnergy...49.56.2 + 
    fBodyAcc.bandsEnergy...57.64.2 + fBodyAcc.bandsEnergy...1.16.2 + 
    fBodyAcc.bandsEnergy...17.32.2 + fBodyAcc.bandsEnergy...33.48.2 + 
    fBodyAcc.bandsEnergy...49.64.2 + fBodyAcc.bandsEnergy...1.24.2 + 
    fBodyAcc.bandsEnergy...25.48.2 + fBodyAccJerk.mean...X + 
    fBodyAccJerk.mean...Y + fBodyAccJerk.mean...Z + fBodyAccJerk.std...X + 
    fBodyAccJerk.std...Y + fBodyAccJerk.std...Z + fBodyAccJerk.mad...X + 
    fBodyAccJerk.mad...Y + fBodyAccJerk.mad...Z + fBodyAccJerk.max...X + 
    fBodyAccJerk.max...Y + fBodyAccJerk.max...Z + fBodyAccJerk.min...X + 
    fBodyAccJerk.min...Y + fBodyAccJerk.min...Z + fBodyAccJerk.sma.. + 
    fBodyAccJerk.energy...X + fBodyAccJerk.energy...Y + fBodyAccJerk.energy...Z + 
    fBodyAccJerk.iqr...X + fBodyAccJerk.iqr...Y + fBodyAccJerk.iqr...Z + 
    fBodyAccJerk.entropy...X + fBodyAccJerk.entropy...Y + fBodyAccJerk.entropy...Z + 
    fBodyAccJerk.maxInds.X + fBodyAccJerk.maxInds.Y + fBodyAccJerk.maxInds.Z + 
    fBodyAccJerk.meanFreq...X + fBodyAccJerk.meanFreq...Y + fBodyAccJerk.meanFreq...Z + 
    fBodyAccJerk.skewness...X + fBodyAccJerk.kurtosis...X + fBodyAccJerk.skewness...Y + 
    fBodyAccJerk.kurtosis...Y + fBodyAccJerk.skewness...Z + fBodyAccJerk.kurtosis...Z + 
    fBodyAccJerk.bandsEnergy...1.8 + fBodyAccJerk.bandsEnergy...9.16 + 
    fBodyAccJerk.bandsEnergy...17.24 + fBodyAccJerk.bandsEnergy...25.32 + 
    fBodyAccJerk.bandsEnergy...33.40 + fBodyAccJerk.bandsEnergy...41.48 + 
    fBodyAccJerk.bandsEnergy...49.56 + fBodyAccJerk.bandsEnergy...57.64 + 
    fBodyAccJerk.bandsEnergy...1.16 + fBodyAccJerk.bandsEnergy...17.32 + 
    fBodyAccJerk.bandsEnergy...33.48 + fBodyAccJerk.bandsEnergy...49.64 + 
    fBodyAccJerk.bandsEnergy...1.24 + fBodyAccJerk.bandsEnergy...25.48 + 
    fBodyAccJerk.bandsEnergy...1.8.1 + fBodyAccJerk.bandsEnergy...9.16.1 + 
    fBodyAccJerk.bandsEnergy...17.24.1 + fBodyAccJerk.bandsEnergy...25.32.1 + 
    fBodyAccJerk.bandsEnergy...33.40.1 + fBodyAccJerk.bandsEnergy...41.48.1 +fBodyAccJerk.bandsEnergy...49.56.1 + fBodyAccJerk.bandsEnergy...57.64.1 + 
    fBodyAccJerk.bandsEnergy...1.16.1 + fBodyAccJerk.bandsEnergy...17.32.1 + 
    fBodyAccJerk.bandsEnergy...33.48.1 + fBodyAccJerk.bandsEnergy...49.64.1 + 
    fBodyAccJerk.bandsEnergy...1.24.1 + fBodyAccJerk.bandsEnergy...25.48.1 + 
    fBodyAccJerk.bandsEnergy...1.8.2 + fBodyAccJerk.bandsEnergy...9.16.2 + 
    fBodyAccJerk.bandsEnergy...17.24.2 + fBodyAccJerk.bandsEnergy...25.32.2 + 
    fBodyAccJerk.bandsEnergy...33.40.2 + fBodyAccJerk.bandsEnergy...41.48.2 + 
    fBodyAccJerk.bandsEnergy...49.56.2 + fBodyAccJerk.bandsEnergy...57.64.2 + 
    fBodyAccJerk.bandsEnergy...1.16.2 + fBodyAccJerk.bandsEnergy...17.32.2 + 
    fBodyAccJerk.bandsEnergy...33.48.2 + fBodyAccJerk.bandsEnergy...49.64.2 + 
    fBodyAccJerk.bandsEnergy...1.24.2 + fBodyAccJerk.bandsEnergy...25.48.2 + 
    fBodyGyro.mean...X + fBodyGyro.mean...Y + fBodyGyro.mean...Z + 
    fBodyGyro.std...X + fBodyGyro.std...Y + fBodyGyro.std...Z + 
    fBodyGyro.mad...X + fBodyGyro.mad...Y + fBodyGyro.mad...Z + 
    fBodyGyro.max...X + fBodyGyro.max...Y + fBodyGyro.max...Z + 
    fBodyGyro.min...X + fBodyGyro.min...Y + fBodyGyro.min...Z + 
    fBodyGyro.sma.. + fBodyGyro.energy...X + fBodyGyro.energy...Y + 
    fBodyGyro.energy...Z + fBodyGyro.iqr...X + fBodyGyro.iqr...Y + 
    fBodyGyro.iqr...Z + fBodyGyro.entropy...X + fBodyGyro.entropy...Y + 
    fBodyGyro.entropy...Z + fBodyGyro.maxInds.X + fBodyGyro.maxInds.Y + 
    fBodyGyro.maxInds.Z + fBodyGyro.meanFreq...X + fBodyGyro.meanFreq...Y + 
    fBodyGyro.meanFreq...Z + fBodyGyro.skewness...X + fBodyGyro.kurtosis...X + 
    fBodyGyro.skewness...Y + fBodyGyro.kurtosis...Y + fBodyGyro.skewness...Z + 
    fBodyGyro.kurtosis...Z + fBodyGyro.bandsEnergy...1.8 + fBodyGyro.bandsEnergy...9.16 + 
    fBodyGyro.bandsEnergy...17.24 + fBodyGyro.bandsEnergy...25.32 + 
    fBodyGyro.bandsEnergy...33.40 + fBodyGyro.bandsEnergy...41.48 + 
    fBodyGyro.bandsEnergy...49.56 + fBodyGyro.bandsEnergy...57.64 + 
    fBodyGyro.bandsEnergy...1.16 + fBodyGyro.bandsEnergy...17.32 + 
    fBodyGyro.bandsEnergy...33.48 + fBodyGyro.bandsEnergy...49.64 + 
    fBodyGyro.bandsEnergy...1.24 + fBodyGyro.bandsEnergy...25.48 + 
    fBodyGyro.bandsEnergy...1.8.1 + fBodyGyro.bandsEnergy...9.16.1 + 
    fBodyGyro.bandsEnergy...17.24.1 + fBodyGyro.bandsEnergy...25.32.1 + 
    fBodyGyro.bandsEnergy...33.40.1 + fBodyGyro.bandsEnergy...41.48.1 + 
    fBodyGyro.bandsEnergy...49.56.1 + fBodyGyro.bandsEnergy...57.64.1 + 
    fBodyGyro.bandsEnergy...1.16.1 + fBodyGyro.bandsEnergy...17.32.1 + 
    fBodyGyro.bandsEnergy...33.48.1 + fBodyGyro.bandsEnergy...49.64.1 + 
    fBodyGyro.bandsEnergy...1.24.1 + fBodyGyro.bandsEnergy...25.48.1 + 
    fBodyGyro.bandsEnergy...1.8.2 + fBodyGyro.bandsEnergy...9.16.2 + 
    fBodyGyro.bandsEnergy...17.24.2 + fBodyGyro.bandsEnergy...25.32.2 + 
    fBodyGyro.bandsEnergy...33.40.2 + fBodyGyro.bandsEnergy...41.48.2 + 
    fBodyGyro.bandsEnergy...49.56.2 + fBodyGyro.bandsEnergy...57.64.2 + 
    fBodyGyro.bandsEnergy...1.16.2 + fBodyGyro.bandsEnergy...17.32.2 + 
    fBodyGyro.bandsEnergy...33.48.2 + fBodyGyro.bandsEnergy...49.64.2 + 
    fBodyGyro.bandsEnergy...1.24.2 + fBodyGyro.bandsEnergy...25.48.2 + 
    fBodyAccMag.mean.. + fBodyAccMag.std.. + fBodyAccMag.mad.. + 
    fBodyAccMag.max.. + fBodyAccMag.min.. + fBodyAccMag.sma.. + 
    fBodyAccMag.energy.. + fBodyAccMag.iqr.. + fBodyAccMag.entropy.. + 
    fBodyAccMag.maxInds + fBodyAccMag.meanFreq.. + fBodyAccMag.skewness.. + 
    fBodyAccMag.kurtosis.. + fBodyBodyAccJerkMag.mean.. + fBodyBodyAccJerkMag.std.. + 
    fBodyBodyAccJerkMag.mad.. + fBodyBodyAccJerkMag.max.. + fBodyBodyAccJerkMag.min.. + 
    fBodyBodyAccJerkMag.sma.. + fBodyBodyAccJerkMag.energy.. + 
    fBodyBodyAccJerkMag.iqr.. + fBodyBodyAccJerkMag.entropy.. + 
    fBodyBodyAccJerkMag.maxInds + fBodyBodyAccJerkMag.meanFreq.. + 
    fBodyBodyAccJerkMag.skewness.. + fBodyBodyAccJerkMag.kurtosis.. + fBodyBodyGyroMag.mean.. + fBodyBodyGyroMag.std.. + fBodyBodyGyroMag.mad.. + 
    fBodyBodyGyroMag.max.. + fBodyBodyGyroMag.min.. + fBodyBodyGyroMag.sma.. + 
    fBodyBodyGyroMag.energy.. + fBodyBodyGyroMag.iqr.. + fBodyBodyGyroMag.entropy.. + 
    fBodyBodyGyroMag.maxInds + fBodyBodyGyroMag.meanFreq.. + 
    fBodyBodyGyroMag.skewness.. + fBodyBodyGyroMag.kurtosis.. + 
    fBodyBodyGyroJerkMag.mean.. + fBodyBodyGyroJerkMag.std.. + 
    fBodyBodyGyroJerkMag.mad.. + fBodyBodyGyroJerkMag.max.. + 
    fBodyBodyGyroJerkMag.min.. + fBodyBodyGyroJerkMag.sma.. + 
    fBodyBodyGyroJerkMag.energy.. + fBodyBodyGyroJerkMag.iqr.. + 
    fBodyBodyGyroJerkMag.entropy.. + fBodyBodyGyroJerkMag.maxInds + 
    fBodyBodyGyroJerkMag.meanFreq.. + fBodyBodyGyroJerkMag.skewness.. + 
    fBodyBodyGyroJerkMag.kurtosis.. + angle.tBodyAccMean.gravity. + 
    angle.tBodyAccJerkMean..gravityMean. + angle.tBodyGyroMean.gravityMean. + 
    angle.tBodyGyroJerkMean.gravityMean. + angle.X.gravityMean. + 
    angle.Y.gravityMean. + angle.Z.gravityMean. + subject
  , train.data,  hidden = 6, linear.output = FALSE, threshold=0.3)

```

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
train.data3 <- train.data
training.prediction <- compute(n87, train.data3[,1:562])
training.class <- apply(training.prediction$net.result,1,which.max)-1


revalue(train.data3$Activity, c("LAYING" = 0)) -> train.data3$Activity
revalue(train.data3$Activity, c("SITTING" = 1)) -> train.data3$Activity
revalue(train.data3$Activity, c("STANDING" = 2)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING" = 3)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> train.data3$Activity


original_values <- as.factor(train.data3$Activity)
mean(as.factor(training.class) == original_values)
confusionMatrix(as.factor(training.class), as.factor(train.data3$Activity))
table(as.factor(train.data3$Activity), training.class)


```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (testing set)
valid.data3 <- valid.data
validation.prediction <- compute(n87, valid.data3[,1:562])
validation.class <- apply(validation.prediction$net.result,1,which.max)-1


revalue(valid.data3$Activity, c("LAYING" = 0)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("SITTING" = 1)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("STANDING" = 2)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING" = 3)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> valid.data3$Activity


original_values_valid <- as.factor(valid.data3$Activity)
mean(as.factor(validation.class) == original_values_valid)
confusionMatrix(as.factor(validation.class), as.factor(valid.data3$Activity))
table(as.factor(valid.data3$Activity), validation.class)


```
# NN9 hidden = 10
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
nn9 <- neuralnet((Activity == "LAYING") + (Activity == "SITTING")+ (Activity == "STANDING")+ (Activity == "WALKING") + (Activity == "WALKING_DOWNSTAIRS") + (Activity == "WALKING_UPSTAIRS") ~ tBodyAcc.mean...X + tBodyAcc.mean...Y + tBodyAcc.mean...Z + tBodyAcc.std...X + 
    tBodyAcc.std...Y + tBodyAcc.std...Z + tBodyAcc.mad...X + 
    tBodyAcc.mad...Y + tBodyAcc.mad...Z + tBodyAcc.max...X + 
    tBodyAcc.max...Y + tBodyAcc.max...Z + tBodyAcc.min...X + 
    tBodyAcc.min...Y + tBodyAcc.min...Z + tBodyAcc.sma.. + tBodyAcc.energy...X + 
    tBodyAcc.energy...Y + tBodyAcc.energy...Z + tBodyAcc.iqr...X + 
    tBodyAcc.iqr...Y + tBodyAcc.iqr...Z + tBodyAcc.entropy...X + 
    tBodyAcc.entropy...Y + tBodyAcc.entropy...Z + tBodyAcc.arCoeff...X.1 + 
    tBodyAcc.arCoeff...X.2 + tBodyAcc.arCoeff...X.3 + tBodyAcc.arCoeff...X.4 + 
    tBodyAcc.arCoeff...Y.1 + tBodyAcc.arCoeff...Y.2 + tBodyAcc.arCoeff...Y.3 + 
    tBodyAcc.arCoeff...Y.4 + tBodyAcc.arCoeff...Z.1 + tBodyAcc.arCoeff...Z.2 + 
    tBodyAcc.arCoeff...Z.3 + tBodyAcc.arCoeff...Z.4 + tBodyAcc.correlation...X.Y + 
    tBodyAcc.correlation...X.Z + tBodyAcc.correlation...Y.Z + 
    tGravityAcc.mean...X + tGravityAcc.mean...Y + tGravityAcc.mean...Z + 
    tGravityAcc.std...X + tGravityAcc.std...Y + tGravityAcc.std...Z + 
    tGravityAcc.mad...X + tGravityAcc.mad...Y + tGravityAcc.mad...Z + 
    tGravityAcc.max...X + tGravityAcc.max...Y + tGravityAcc.max...Z + 
    tGravityAcc.min...X + tGravityAcc.min...Y + tGravityAcc.min...Z + 
    tGravityAcc.sma.. + tGravityAcc.energy...X + tGravityAcc.energy...Y + 
    tGravityAcc.energy...Z + tGravityAcc.iqr...X + tGravityAcc.iqr...Y + 
    tGravityAcc.iqr...Z + tGravityAcc.entropy...X + tGravityAcc.entropy...Y + 
    tGravityAcc.entropy...Z + tGravityAcc.arCoeff...X.1 + tGravityAcc.arCoeff...X.2 + 
    tGravityAcc.arCoeff...X.3 + tGravityAcc.arCoeff...X.4 + tGravityAcc.arCoeff...Y.1 + 
    tGravityAcc.arCoeff...Y.2 + tGravityAcc.arCoeff...Y.3 + tGravityAcc.arCoeff...Y.4 + 
    tGravityAcc.arCoeff...Z.1 + tGravityAcc.arCoeff...Z.2 + tGravityAcc.arCoeff...Z.3 + 
    tGravityAcc.arCoeff...Z.4 + tGravityAcc.correlation...X.Y + 
    tGravityAcc.correlation...X.Z + tGravityAcc.correlation...Y.Z + 
    tBodyAccJerk.mean...X + tBodyAccJerk.mean...Y + tBodyAccJerk.mean...Z + 
    tBodyAccJerk.std...X + tBodyAccJerk.std...Y + tBodyAccJerk.std...Z + 
    tBodyAccJerk.mad...X + tBodyAccJerk.mad...Y + tBodyAccJerk.mad...Z + 
    tBodyAccJerk.max...X + tBodyAccJerk.max...Y + tBodyAccJerk.max...Z + 
    tBodyAccJerk.min...X + tBodyAccJerk.min...Y + tBodyAccJerk.min...Z + 
    tBodyAccJerk.sma.. + tBodyAccJerk.energy...X + tBodyAccJerk.energy...Y + 
    tBodyAccJerk.energy...Z + tBodyAccJerk.iqr...X + tBodyAccJerk.iqr...Y + 
    tBodyAccJerk.iqr...Z + tBodyAccJerk.entropy...X + tBodyAccJerk.entropy...Y + 
    tBodyAccJerk.entropy...Z + tBodyAccJerk.arCoeff...X.1 + tBodyAccJerk.arCoeff...X.2 + 
    tBodyAccJerk.arCoeff...X.3 + tBodyAccJerk.arCoeff...X.4 + 
    tBodyAccJerk.arCoeff...Y.1 + tBodyAccJerk.arCoeff...Y.2 + 
    tBodyAccJerk.arCoeff...Y.3 + tBodyAccJerk.arCoeff...Y.4 + tBodyAccJerk.arCoeff...Z.1 + tBodyAccJerk.arCoeff...Z.2 + 
    tBodyAccJerk.arCoeff...Z.3 + tBodyAccJerk.arCoeff...Z.4 + 
    tBodyAccJerk.correlation...X.Y + tBodyAccJerk.correlation...X.Z + 
    tBodyAccJerk.correlation...Y.Z + tBodyGyro.mean...X + tBodyGyro.mean...Y + 
    tBodyGyro.mean...Z + tBodyGyro.std...X + tBodyGyro.std...Y + 
    tBodyGyro.std...Z + tBodyGyro.mad...X + tBodyGyro.mad...Y + 
    tBodyGyro.mad...Z + tBodyGyro.max...X + tBodyGyro.max...Y + 
    tBodyGyro.max...Z + tBodyGyro.min...X + tBodyGyro.min...Y + 
    tBodyGyro.min...Z + tBodyGyro.sma.. + tBodyGyro.energy...X + 
    tBodyGyro.energy...Y + tBodyGyro.energy...Z + tBodyGyro.iqr...X + 
    tBodyGyro.iqr...Y + tBodyGyro.iqr...Z + tBodyGyro.entropy...X + 
    tBodyGyro.entropy...Y + tBodyGyro.entropy...Z + tBodyGyro.arCoeff...X.1 + 
    tBodyGyro.arCoeff...X.2 + tBodyGyro.arCoeff...X.3 + tBodyGyro.arCoeff...X.4 + 
    tBodyGyro.arCoeff...Y.1 + tBodyGyro.arCoeff...Y.2 + tBodyGyro.arCoeff...Y.3 + 
    tBodyGyro.arCoeff...Y.4 + tBodyGyro.arCoeff...Z.1 + tBodyGyro.arCoeff...Z.2 + 
    tBodyGyro.arCoeff...Z.3 + tBodyGyro.arCoeff...Z.4 + tBodyGyro.correlation...X.Y + 
    tBodyGyro.correlation...X.Z + tBodyGyro.correlation...Y.Z + 
    tBodyGyroJerk.mean...X + tBodyGyroJerk.mean...Y + tBodyGyroJerk.mean...Z + 
    tBodyGyroJerk.std...X + tBodyGyroJerk.std...Y + tBodyGyroJerk.std...Z + 
    tBodyGyroJerk.mad...X + tBodyGyroJerk.mad...Y + tBodyGyroJerk.mad...Z + 
    tBodyGyroJerk.max...X + tBodyGyroJerk.max...Y + tBodyGyroJerk.max...Z + 
    tBodyGyroJerk.min...X + tBodyGyroJerk.min...Y + tBodyGyroJerk.min...Z + 
    tBodyGyroJerk.sma.. + tBodyGyroJerk.energy...X + tBodyGyroJerk.energy...Y + 
    tBodyGyroJerk.energy...Z + tBodyGyroJerk.iqr...X + tBodyGyroJerk.iqr...Y + 
    tBodyGyroJerk.iqr...Z + tBodyGyroJerk.entropy...X + tBodyGyroJerk.entropy...Y + 
    tBodyGyroJerk.entropy...Z + tBodyGyroJerk.arCoeff...X.1 + 
    tBodyGyroJerk.arCoeff...X.2 + tBodyGyroJerk.arCoeff...X.3 + 
    tBodyGyroJerk.arCoeff...X.4 + tBodyGyroJerk.arCoeff...Y.1 + 
    tBodyGyroJerk.arCoeff...Y.2 + tBodyGyroJerk.arCoeff...Y.3 + 
    tBodyGyroJerk.arCoeff...Y.4 + tBodyGyroJerk.arCoeff...Z.1 + 
    tBodyGyroJerk.arCoeff...Z.2 + tBodyGyroJerk.arCoeff...Z.3 + 
    tBodyGyroJerk.arCoeff...Z.4 + tBodyGyroJerk.correlation...X.Y + 
    tBodyGyroJerk.correlation...X.Z + tBodyGyroJerk.correlation...Y.Z + 
    tBodyAccMag.mean.. + tBodyAccMag.std.. + tBodyAccMag.mad.. + 
    tBodyAccMag.max.. + tBodyAccMag.min.. + tBodyAccMag.sma.. + 
    tBodyAccMag.energy.. + tBodyAccMag.iqr.. + tBodyAccMag.entropy.. + 
    tBodyAccMag.arCoeff..1 + tBodyAccMag.arCoeff..2 + tBodyAccMag.arCoeff..3 + 
    tBodyAccMag.arCoeff..4 + tGravityAccMag.mean.. + tGravityAccMag.std.. + 
    tGravityAccMag.mad.. + tGravityAccMag.max.. + tGravityAccMag.min.. + 
    tGravityAccMag.sma.. + tGravityAccMag.energy.. + tGravityAccMag.iqr.. + 
    tGravityAccMag.entropy.. + tGravityAccMag.arCoeff..1 + tGravityAccMag.arCoeff..2 + 
    tGravityAccMag.arCoeff..3 + tGravityAccMag.arCoeff..4 + tBodyAccJerkMag.mean.. + 
    tBodyAccJerkMag.std.. + tBodyAccJerkMag.mad.. + tBodyAccJerkMag.max.. + 
    tBodyAccJerkMag.min.. + tBodyAccJerkMag.sma.. + tBodyAccJerkMag.energy.. + 
    tBodyAccJerkMag.iqr.. + tBodyAccJerkMag.entropy.. + tBodyAccJerkMag.arCoeff..1 + 
    tBodyAccJerkMag.arCoeff..2 + tBodyAccJerkMag.arCoeff..3 + 
    tBodyAccJerkMag.arCoeff..4 + tBodyGyroMag.mean.. + tBodyGyroMag.std.. + 
    tBodyGyroMag.mad.. + tBodyGyroMag.max.. + tBodyGyroMag.min.. + 
    tBodyGyroMag.sma.. + tBodyGyroMag.energy.. + tBodyGyroMag.iqr.. + 
    tBodyGyroMag.entropy.. + tBodyGyroMag.arCoeff..1 + tBodyGyroMag.arCoeff..2 + 
    tBodyGyroMag.arCoeff..3 + tBodyGyroMag.arCoeff..4 + tBodyGyroJerkMag.mean.. + 
    tBodyGyroJerkMag.std.. + tBodyGyroJerkMag.mad.. + tBodyGyroJerkMag.max.. + 
    tBodyGyroJerkMag.min.. + tBodyGyroJerkMag.sma.. + tBodyGyroJerkMag.energy.. + 
    tBodyGyroJerkMag.iqr.. + tBodyGyroJerkMag.entropy.. + tBodyGyroJerkMag.arCoeff..1 + 
    tBodyGyroJerkMag.arCoeff..2 + tBodyGyroJerkMag.arCoeff..3 +tBodyGyroJerkMag.arCoeff..4 + fBodyAcc.mean...X + fBodyAcc.mean...Y + 
    fBodyAcc.mean...Z + fBodyAcc.std...X + fBodyAcc.std...Y + 
    fBodyAcc.std...Z + fBodyAcc.mad...X + fBodyAcc.mad...Y + 
    fBodyAcc.mad...Z + fBodyAcc.max...X + fBodyAcc.max...Y + 
    fBodyAcc.max...Z + fBodyAcc.min...X + fBodyAcc.min...Y + 
    fBodyAcc.min...Z + fBodyAcc.sma.. + fBodyAcc.energy...X + 
    fBodyAcc.energy...Y + fBodyAcc.energy...Z + fBodyAcc.iqr...X + 
    fBodyAcc.iqr...Y + fBodyAcc.iqr...Z + fBodyAcc.entropy...X + 
    fBodyAcc.entropy...Y + fBodyAcc.entropy...Z + fBodyAcc.maxInds.X + 
    fBodyAcc.maxInds.Y + fBodyAcc.maxInds.Z + fBodyAcc.meanFreq...X + 
    fBodyAcc.meanFreq...Y + fBodyAcc.meanFreq...Z + fBodyAcc.skewness...X + 
    fBodyAcc.kurtosis...X + fBodyAcc.skewness...Y + fBodyAcc.kurtosis...Y + 
    fBodyAcc.skewness...Z + fBodyAcc.kurtosis...Z + fBodyAcc.bandsEnergy...1.8 + 
    fBodyAcc.bandsEnergy...9.16 + fBodyAcc.bandsEnergy...17.24 + 
    fBodyAcc.bandsEnergy...25.32 + fBodyAcc.bandsEnergy...33.40 + 
    fBodyAcc.bandsEnergy...41.48 + fBodyAcc.bandsEnergy...49.56 + 
    fBodyAcc.bandsEnergy...57.64 + fBodyAcc.bandsEnergy...1.16 + 
    fBodyAcc.bandsEnergy...17.32 + fBodyAcc.bandsEnergy...33.48 + 
    fBodyAcc.bandsEnergy...49.64 + fBodyAcc.bandsEnergy...1.24 + 
    fBodyAcc.bandsEnergy...25.48 + fBodyAcc.bandsEnergy...1.8.1 + 
    fBodyAcc.bandsEnergy...9.16.1 + fBodyAcc.bandsEnergy...17.24.1 + 
    fBodyAcc.bandsEnergy...25.32.1 + fBodyAcc.bandsEnergy...33.40.1 + 
    fBodyAcc.bandsEnergy...41.48.1 + fBodyAcc.bandsEnergy...49.56.1 + 
    fBodyAcc.bandsEnergy...57.64.1 + fBodyAcc.bandsEnergy...1.16.1 + 
    fBodyAcc.bandsEnergy...17.32.1 + fBodyAcc.bandsEnergy...33.48.1 + 
    fBodyAcc.bandsEnergy...49.64.1 + fBodyAcc.bandsEnergy...1.24.1 + 
    fBodyAcc.bandsEnergy...25.48.1 + fBodyAcc.bandsEnergy...1.8.2 + 
    fBodyAcc.bandsEnergy...9.16.2 + fBodyAcc.bandsEnergy...17.24.2 + 
    fBodyAcc.bandsEnergy...25.32.2 + fBodyAcc.bandsEnergy...33.40.2 + 
    fBodyAcc.bandsEnergy...41.48.2 + fBodyAcc.bandsEnergy...49.56.2 + 
    fBodyAcc.bandsEnergy...57.64.2 + fBodyAcc.bandsEnergy...1.16.2 + 
    fBodyAcc.bandsEnergy...17.32.2 + fBodyAcc.bandsEnergy...33.48.2 + 
    fBodyAcc.bandsEnergy...49.64.2 + fBodyAcc.bandsEnergy...1.24.2 + 
    fBodyAcc.bandsEnergy...25.48.2 + fBodyAccJerk.mean...X + 
    fBodyAccJerk.mean...Y + fBodyAccJerk.mean...Z + fBodyAccJerk.std...X + 
    fBodyAccJerk.std...Y + fBodyAccJerk.std...Z + fBodyAccJerk.mad...X + 
    fBodyAccJerk.mad...Y + fBodyAccJerk.mad...Z + fBodyAccJerk.max...X + 
    fBodyAccJerk.max...Y + fBodyAccJerk.max...Z + fBodyAccJerk.min...X + 
    fBodyAccJerk.min...Y + fBodyAccJerk.min...Z + fBodyAccJerk.sma.. + 
    fBodyAccJerk.energy...X + fBodyAccJerk.energy...Y + fBodyAccJerk.energy...Z + 
    fBodyAccJerk.iqr...X + fBodyAccJerk.iqr...Y + fBodyAccJerk.iqr...Z + 
    fBodyAccJerk.entropy...X + fBodyAccJerk.entropy...Y + fBodyAccJerk.entropy...Z + 
    fBodyAccJerk.maxInds.X + fBodyAccJerk.maxInds.Y + fBodyAccJerk.maxInds.Z + 
    fBodyAccJerk.meanFreq...X + fBodyAccJerk.meanFreq...Y + fBodyAccJerk.meanFreq...Z + 
    fBodyAccJerk.skewness...X + fBodyAccJerk.kurtosis...X + fBodyAccJerk.skewness...Y + 
    fBodyAccJerk.kurtosis...Y + fBodyAccJerk.skewness...Z + fBodyAccJerk.kurtosis...Z + 
    fBodyAccJerk.bandsEnergy...1.8 + fBodyAccJerk.bandsEnergy...9.16 + 
    fBodyAccJerk.bandsEnergy...17.24 + fBodyAccJerk.bandsEnergy...25.32 + 
    fBodyAccJerk.bandsEnergy...33.40 + fBodyAccJerk.bandsEnergy...41.48 + 
    fBodyAccJerk.bandsEnergy...49.56 + fBodyAccJerk.bandsEnergy...57.64 + 
    fBodyAccJerk.bandsEnergy...1.16 + fBodyAccJerk.bandsEnergy...17.32 + 
    fBodyAccJerk.bandsEnergy...33.48 + fBodyAccJerk.bandsEnergy...49.64 + 
    fBodyAccJerk.bandsEnergy...1.24 + fBodyAccJerk.bandsEnergy...25.48 + 
    fBodyAccJerk.bandsEnergy...1.8.1 + fBodyAccJerk.bandsEnergy...9.16.1 + 
    fBodyAccJerk.bandsEnergy...17.24.1 + fBodyAccJerk.bandsEnergy...25.32.1 + 
    fBodyAccJerk.bandsEnergy...33.40.1 + fBodyAccJerk.bandsEnergy...41.48.1 +fBodyAccJerk.bandsEnergy...49.56.1 + fBodyAccJerk.bandsEnergy...57.64.1 + 
    fBodyAccJerk.bandsEnergy...1.16.1 + fBodyAccJerk.bandsEnergy...17.32.1 + 
    fBodyAccJerk.bandsEnergy...33.48.1 + fBodyAccJerk.bandsEnergy...49.64.1 + 
    fBodyAccJerk.bandsEnergy...1.24.1 + fBodyAccJerk.bandsEnergy...25.48.1 + 
    fBodyAccJerk.bandsEnergy...1.8.2 + fBodyAccJerk.bandsEnergy...9.16.2 + 
    fBodyAccJerk.bandsEnergy...17.24.2 + fBodyAccJerk.bandsEnergy...25.32.2 + 
    fBodyAccJerk.bandsEnergy...33.40.2 + fBodyAccJerk.bandsEnergy...41.48.2 + 
    fBodyAccJerk.bandsEnergy...49.56.2 + fBodyAccJerk.bandsEnergy...57.64.2 + 
    fBodyAccJerk.bandsEnergy...1.16.2 + fBodyAccJerk.bandsEnergy...17.32.2 + 
    fBodyAccJerk.bandsEnergy...33.48.2 + fBodyAccJerk.bandsEnergy...49.64.2 + 
    fBodyAccJerk.bandsEnergy...1.24.2 + fBodyAccJerk.bandsEnergy...25.48.2 + 
    fBodyGyro.mean...X + fBodyGyro.mean...Y + fBodyGyro.mean...Z + 
    fBodyGyro.std...X + fBodyGyro.std...Y + fBodyGyro.std...Z + 
    fBodyGyro.mad...X + fBodyGyro.mad...Y + fBodyGyro.mad...Z + 
    fBodyGyro.max...X + fBodyGyro.max...Y + fBodyGyro.max...Z + 
    fBodyGyro.min...X + fBodyGyro.min...Y + fBodyGyro.min...Z + 
    fBodyGyro.sma.. + fBodyGyro.energy...X + fBodyGyro.energy...Y + 
    fBodyGyro.energy...Z + fBodyGyro.iqr...X + fBodyGyro.iqr...Y + 
    fBodyGyro.iqr...Z + fBodyGyro.entropy...X + fBodyGyro.entropy...Y + 
    fBodyGyro.entropy...Z + fBodyGyro.maxInds.X + fBodyGyro.maxInds.Y + 
    fBodyGyro.maxInds.Z + fBodyGyro.meanFreq...X + fBodyGyro.meanFreq...Y + 
    fBodyGyro.meanFreq...Z + fBodyGyro.skewness...X + fBodyGyro.kurtosis...X + 
    fBodyGyro.skewness...Y + fBodyGyro.kurtosis...Y + fBodyGyro.skewness...Z + 
    fBodyGyro.kurtosis...Z + fBodyGyro.bandsEnergy...1.8 + fBodyGyro.bandsEnergy...9.16 + 
    fBodyGyro.bandsEnergy...17.24 + fBodyGyro.bandsEnergy...25.32 + 
    fBodyGyro.bandsEnergy...33.40 + fBodyGyro.bandsEnergy...41.48 + 
    fBodyGyro.bandsEnergy...49.56 + fBodyGyro.bandsEnergy...57.64 + 
    fBodyGyro.bandsEnergy...1.16 + fBodyGyro.bandsEnergy...17.32 + 
    fBodyGyro.bandsEnergy...33.48 + fBodyGyro.bandsEnergy...49.64 + 
    fBodyGyro.bandsEnergy...1.24 + fBodyGyro.bandsEnergy...25.48 + 
    fBodyGyro.bandsEnergy...1.8.1 + fBodyGyro.bandsEnergy...9.16.1 + 
    fBodyGyro.bandsEnergy...17.24.1 + fBodyGyro.bandsEnergy...25.32.1 + 
    fBodyGyro.bandsEnergy...33.40.1 + fBodyGyro.bandsEnergy...41.48.1 + 
    fBodyGyro.bandsEnergy...49.56.1 + fBodyGyro.bandsEnergy...57.64.1 + 
    fBodyGyro.bandsEnergy...1.16.1 + fBodyGyro.bandsEnergy...17.32.1 + 
    fBodyGyro.bandsEnergy...33.48.1 + fBodyGyro.bandsEnergy...49.64.1 + 
    fBodyGyro.bandsEnergy...1.24.1 + fBodyGyro.bandsEnergy...25.48.1 + 
    fBodyGyro.bandsEnergy...1.8.2 + fBodyGyro.bandsEnergy...9.16.2 + 
    fBodyGyro.bandsEnergy...17.24.2 + fBodyGyro.bandsEnergy...25.32.2 + 
    fBodyGyro.bandsEnergy...33.40.2 + fBodyGyro.bandsEnergy...41.48.2 + 
    fBodyGyro.bandsEnergy...49.56.2 + fBodyGyro.bandsEnergy...57.64.2 + 
    fBodyGyro.bandsEnergy...1.16.2 + fBodyGyro.bandsEnergy...17.32.2 + 
    fBodyGyro.bandsEnergy...33.48.2 + fBodyGyro.bandsEnergy...49.64.2 + 
    fBodyGyro.bandsEnergy...1.24.2 + fBodyGyro.bandsEnergy...25.48.2 + 
    fBodyAccMag.mean.. + fBodyAccMag.std.. + fBodyAccMag.mad.. + 
    fBodyAccMag.max.. + fBodyAccMag.min.. + fBodyAccMag.sma.. + 
    fBodyAccMag.energy.. + fBodyAccMag.iqr.. + fBodyAccMag.entropy.. + 
    fBodyAccMag.maxInds + fBodyAccMag.meanFreq.. + fBodyAccMag.skewness.. + 
    fBodyAccMag.kurtosis.. + fBodyBodyAccJerkMag.mean.. + fBodyBodyAccJerkMag.std.. + 
    fBodyBodyAccJerkMag.mad.. + fBodyBodyAccJerkMag.max.. + fBodyBodyAccJerkMag.min.. + 
    fBodyBodyAccJerkMag.sma.. + fBodyBodyAccJerkMag.energy.. + 
    fBodyBodyAccJerkMag.iqr.. + fBodyBodyAccJerkMag.entropy.. + 
    fBodyBodyAccJerkMag.maxInds + fBodyBodyAccJerkMag.meanFreq.. + 
    fBodyBodyAccJerkMag.skewness.. + fBodyBodyAccJerkMag.kurtosis.. + fBodyBodyGyroMag.mean.. + fBodyBodyGyroMag.std.. + fBodyBodyGyroMag.mad.. + 
    fBodyBodyGyroMag.max.. + fBodyBodyGyroMag.min.. + fBodyBodyGyroMag.sma.. + 
    fBodyBodyGyroMag.energy.. + fBodyBodyGyroMag.iqr.. + fBodyBodyGyroMag.entropy.. + 
    fBodyBodyGyroMag.maxInds + fBodyBodyGyroMag.meanFreq.. + 
    fBodyBodyGyroMag.skewness.. + fBodyBodyGyroMag.kurtosis.. + 
    fBodyBodyGyroJerkMag.mean.. + fBodyBodyGyroJerkMag.std.. + 
    fBodyBodyGyroJerkMag.mad.. + fBodyBodyGyroJerkMag.max.. + 
    fBodyBodyGyroJerkMag.min.. + fBodyBodyGyroJerkMag.sma.. + 
    fBodyBodyGyroJerkMag.energy.. + fBodyBodyGyroJerkMag.iqr.. + 
    fBodyBodyGyroJerkMag.entropy.. + fBodyBodyGyroJerkMag.maxInds + 
    fBodyBodyGyroJerkMag.meanFreq.. + fBodyBodyGyroJerkMag.skewness.. + 
    fBodyBodyGyroJerkMag.kurtosis.. + angle.tBodyAccMean.gravity. + 
    angle.tBodyAccJerkMean..gravityMean. + angle.tBodyGyroMean.gravityMean. + 
    angle.tBodyGyroJerkMean.gravityMean. + angle.X.gravityMean. + 
    angle.Y.gravityMean. + angle.Z.gravityMean. + subject
  , train.data,  hidden = 10, linear.output = FALSE, threshold=0.3)

```


```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
train.data3 <- train.data
training.prediction <- compute(nn9, train.data3[,1:562])
training.class <- apply(training.prediction$net.result,1,which.max)-1


revalue(train.data3$Activity, c("LAYING" = 0)) -> train.data3$Activity
revalue(train.data3$Activity, c("SITTING" = 1)) -> train.data3$Activity
revalue(train.data3$Activity, c("STANDING" = 2)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING" = 3)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> train.data3$Activity


original_values <- as.factor(train.data3$Activity)
mean(as.factor(training.class) == original_values)
confusionMatrix(as.factor(training.class), as.factor(train.data3$Activity))
table(as.factor(train.data3$Activity), training.class)


```

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (testing set)
valid.data3 <- valid.data
validation.prediction <- compute(nn9, valid.data3[,1:562])
validation.class <- apply(validation.prediction$net.result,1,which.max)-1


revalue(valid.data3$Activity, c("LAYING" = 0)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("SITTING" = 1)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("STANDING" = 2)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING" = 3)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> valid.data3$Activity


original_values_valid <- as.factor(valid.data3$Activity)
mean(as.factor(validation.class) == original_values_valid)
confusionMatrix(as.factor(validation.class), as.factor(valid.data3$Activity))
table(as.factor(valid.data3$Activity), validation.class)


```







#NN10 hidden = c(6, 6)
```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
set.seed(412)
nn10 <- neuralnet((Activity == "LAYING") + (Activity == "SITTING")+ (Activity == "STANDING")+ (Activity == "WALKING") + (Activity == "WALKING_DOWNSTAIRS") + (Activity == "WALKING_UPSTAIRS") ~ tBodyAcc.mean...X + tBodyAcc.mean...Y + tBodyAcc.mean...Z + tBodyAcc.std...X + 
    tBodyAcc.std...Y + tBodyAcc.std...Z + tBodyAcc.mad...X + 
    tBodyAcc.mad...Y + tBodyAcc.mad...Z + tBodyAcc.max...X + 
    tBodyAcc.max...Y + tBodyAcc.max...Z + tBodyAcc.min...X + 
    tBodyAcc.min...Y + tBodyAcc.min...Z + tBodyAcc.sma.. + tBodyAcc.energy...X + 
    tBodyAcc.energy...Y + tBodyAcc.energy...Z + tBodyAcc.iqr...X + 
    tBodyAcc.iqr...Y + tBodyAcc.iqr...Z + tBodyAcc.entropy...X + 
    tBodyAcc.entropy...Y + tBodyAcc.entropy...Z + tBodyAcc.arCoeff...X.1 + 
    tBodyAcc.arCoeff...X.2 + tBodyAcc.arCoeff...X.3 + tBodyAcc.arCoeff...X.4 + 
    tBodyAcc.arCoeff...Y.1 + tBodyAcc.arCoeff...Y.2 + tBodyAcc.arCoeff...Y.3 + 
    tBodyAcc.arCoeff...Y.4 + tBodyAcc.arCoeff...Z.1 + tBodyAcc.arCoeff...Z.2 + 
    tBodyAcc.arCoeff...Z.3 + tBodyAcc.arCoeff...Z.4 + tBodyAcc.correlation...X.Y + 
    tBodyAcc.correlation...X.Z + tBodyAcc.correlation...Y.Z + 
    tGravityAcc.mean...X + tGravityAcc.mean...Y + tGravityAcc.mean...Z + 
    tGravityAcc.std...X + tGravityAcc.std...Y + tGravityAcc.std...Z + 
    tGravityAcc.mad...X + tGravityAcc.mad...Y + tGravityAcc.mad...Z + 
    tGravityAcc.max...X + tGravityAcc.max...Y + tGravityAcc.max...Z + 
    tGravityAcc.min...X + tGravityAcc.min...Y + tGravityAcc.min...Z + 
    tGravityAcc.sma.. + tGravityAcc.energy...X + tGravityAcc.energy...Y + 
    tGravityAcc.energy...Z + tGravityAcc.iqr...X + tGravityAcc.iqr...Y + 
    tGravityAcc.iqr...Z + tGravityAcc.entropy...X + tGravityAcc.entropy...Y + 
    tGravityAcc.entropy...Z + tGravityAcc.arCoeff...X.1 + tGravityAcc.arCoeff...X.2 + 
    tGravityAcc.arCoeff...X.3 + tGravityAcc.arCoeff...X.4 + tGravityAcc.arCoeff...Y.1 + 
    tGravityAcc.arCoeff...Y.2 + tGravityAcc.arCoeff...Y.3 + tGravityAcc.arCoeff...Y.4 + 
    tGravityAcc.arCoeff...Z.1 + tGravityAcc.arCoeff...Z.2 + tGravityAcc.arCoeff...Z.3 + 
    tGravityAcc.arCoeff...Z.4 + tGravityAcc.correlation...X.Y + 
    tGravityAcc.correlation...X.Z + tGravityAcc.correlation...Y.Z + 
    tBodyAccJerk.mean...X + tBodyAccJerk.mean...Y + tBodyAccJerk.mean...Z + 
    tBodyAccJerk.std...X + tBodyAccJerk.std...Y + tBodyAccJerk.std...Z + 
    tBodyAccJerk.mad...X + tBodyAccJerk.mad...Y + tBodyAccJerk.mad...Z + 
    tBodyAccJerk.max...X + tBodyAccJerk.max...Y + tBodyAccJerk.max...Z + 
    tBodyAccJerk.min...X + tBodyAccJerk.min...Y + tBodyAccJerk.min...Z + 
    tBodyAccJerk.sma.. + tBodyAccJerk.energy...X + tBodyAccJerk.energy...Y + 
    tBodyAccJerk.energy...Z + tBodyAccJerk.iqr...X + tBodyAccJerk.iqr...Y + 
    tBodyAccJerk.iqr...Z + tBodyAccJerk.entropy...X + tBodyAccJerk.entropy...Y + 
    tBodyAccJerk.entropy...Z + tBodyAccJerk.arCoeff...X.1 + tBodyAccJerk.arCoeff...X.2 + 
    tBodyAccJerk.arCoeff...X.3 + tBodyAccJerk.arCoeff...X.4 + 
    tBodyAccJerk.arCoeff...Y.1 + tBodyAccJerk.arCoeff...Y.2 + 
    tBodyAccJerk.arCoeff...Y.3 + tBodyAccJerk.arCoeff...Y.4 + tBodyAccJerk.arCoeff...Z.1 + tBodyAccJerk.arCoeff...Z.2 + 
    tBodyAccJerk.arCoeff...Z.3 + tBodyAccJerk.arCoeff...Z.4 + 
    tBodyAccJerk.correlation...X.Y + tBodyAccJerk.correlation...X.Z + 
    tBodyAccJerk.correlation...Y.Z + tBodyGyro.mean...X + tBodyGyro.mean...Y + 
    tBodyGyro.mean...Z + tBodyGyro.std...X + tBodyGyro.std...Y + 
    tBodyGyro.std...Z + tBodyGyro.mad...X + tBodyGyro.mad...Y + 
    tBodyGyro.mad...Z + tBodyGyro.max...X + tBodyGyro.max...Y + 
    tBodyGyro.max...Z + tBodyGyro.min...X + tBodyGyro.min...Y + 
    tBodyGyro.min...Z + tBodyGyro.sma.. + tBodyGyro.energy...X + 
    tBodyGyro.energy...Y + tBodyGyro.energy...Z + tBodyGyro.iqr...X + 
    tBodyGyro.iqr...Y + tBodyGyro.iqr...Z + tBodyGyro.entropy...X + 
    tBodyGyro.entropy...Y + tBodyGyro.entropy...Z + tBodyGyro.arCoeff...X.1 + 
    tBodyGyro.arCoeff...X.2 + tBodyGyro.arCoeff...X.3 + tBodyGyro.arCoeff...X.4 + 
    tBodyGyro.arCoeff...Y.1 + tBodyGyro.arCoeff...Y.2 + tBodyGyro.arCoeff...Y.3 + 
    tBodyGyro.arCoeff...Y.4 + tBodyGyro.arCoeff...Z.1 + tBodyGyro.arCoeff...Z.2 + 
    tBodyGyro.arCoeff...Z.3 + tBodyGyro.arCoeff...Z.4 + tBodyGyro.correlation...X.Y + 
    tBodyGyro.correlation...X.Z + tBodyGyro.correlation...Y.Z + 
    tBodyGyroJerk.mean...X + tBodyGyroJerk.mean...Y + tBodyGyroJerk.mean...Z + 
    tBodyGyroJerk.std...X + tBodyGyroJerk.std...Y + tBodyGyroJerk.std...Z + 
    tBodyGyroJerk.mad...X + tBodyGyroJerk.mad...Y + tBodyGyroJerk.mad...Z + 
    tBodyGyroJerk.max...X + tBodyGyroJerk.max...Y + tBodyGyroJerk.max...Z + 
    tBodyGyroJerk.min...X + tBodyGyroJerk.min...Y + tBodyGyroJerk.min...Z + 
    tBodyGyroJerk.sma.. + tBodyGyroJerk.energy...X + tBodyGyroJerk.energy...Y + 
    tBodyGyroJerk.energy...Z + tBodyGyroJerk.iqr...X + tBodyGyroJerk.iqr...Y + 
    tBodyGyroJerk.iqr...Z + tBodyGyroJerk.entropy...X + tBodyGyroJerk.entropy...Y + 
    tBodyGyroJerk.entropy...Z + tBodyGyroJerk.arCoeff...X.1 + 
    tBodyGyroJerk.arCoeff...X.2 + tBodyGyroJerk.arCoeff...X.3 + 
    tBodyGyroJerk.arCoeff...X.4 + tBodyGyroJerk.arCoeff...Y.1 + 
    tBodyGyroJerk.arCoeff...Y.2 + tBodyGyroJerk.arCoeff...Y.3 + 
    tBodyGyroJerk.arCoeff...Y.4 + tBodyGyroJerk.arCoeff...Z.1 + 
    tBodyGyroJerk.arCoeff...Z.2 + tBodyGyroJerk.arCoeff...Z.3 + 
    tBodyGyroJerk.arCoeff...Z.4 + tBodyGyroJerk.correlation...X.Y + 
    tBodyGyroJerk.correlation...X.Z + tBodyGyroJerk.correlation...Y.Z + 
    tBodyAccMag.mean.. + tBodyAccMag.std.. + tBodyAccMag.mad.. + 
    tBodyAccMag.max.. + tBodyAccMag.min.. + tBodyAccMag.sma.. + 
    tBodyAccMag.energy.. + tBodyAccMag.iqr.. + tBodyAccMag.entropy.. + 
    tBodyAccMag.arCoeff..1 + tBodyAccMag.arCoeff..2 + tBodyAccMag.arCoeff..3 + 
    tBodyAccMag.arCoeff..4 + tGravityAccMag.mean.. + tGravityAccMag.std.. + 
    tGravityAccMag.mad.. + tGravityAccMag.max.. + tGravityAccMag.min.. + 
    tGravityAccMag.sma.. + tGravityAccMag.energy.. + tGravityAccMag.iqr.. + 
    tGravityAccMag.entropy.. + tGravityAccMag.arCoeff..1 + tGravityAccMag.arCoeff..2 + 
    tGravityAccMag.arCoeff..3 + tGravityAccMag.arCoeff..4 + tBodyAccJerkMag.mean.. + 
    tBodyAccJerkMag.std.. + tBodyAccJerkMag.mad.. + tBodyAccJerkMag.max.. + 
    tBodyAccJerkMag.min.. + tBodyAccJerkMag.sma.. + tBodyAccJerkMag.energy.. + 
    tBodyAccJerkMag.iqr.. + tBodyAccJerkMag.entropy.. + tBodyAccJerkMag.arCoeff..1 + 
    tBodyAccJerkMag.arCoeff..2 + tBodyAccJerkMag.arCoeff..3 + 
    tBodyAccJerkMag.arCoeff..4 + tBodyGyroMag.mean.. + tBodyGyroMag.std.. + 
    tBodyGyroMag.mad.. + tBodyGyroMag.max.. + tBodyGyroMag.min.. + 
    tBodyGyroMag.sma.. + tBodyGyroMag.energy.. + tBodyGyroMag.iqr.. + 
    tBodyGyroMag.entropy.. + tBodyGyroMag.arCoeff..1 + tBodyGyroMag.arCoeff..2 + 
    tBodyGyroMag.arCoeff..3 + tBodyGyroMag.arCoeff..4 + tBodyGyroJerkMag.mean.. + 
    tBodyGyroJerkMag.std.. + tBodyGyroJerkMag.mad.. + tBodyGyroJerkMag.max.. + 
    tBodyGyroJerkMag.min.. + tBodyGyroJerkMag.sma.. + tBodyGyroJerkMag.energy.. + 
    tBodyGyroJerkMag.iqr.. + tBodyGyroJerkMag.entropy.. + tBodyGyroJerkMag.arCoeff..1 + 
    tBodyGyroJerkMag.arCoeff..2 + tBodyGyroJerkMag.arCoeff..3 +tBodyGyroJerkMag.arCoeff..4 + fBodyAcc.mean...X + fBodyAcc.mean...Y + 
    fBodyAcc.mean...Z + fBodyAcc.std...X + fBodyAcc.std...Y + 
    fBodyAcc.std...Z + fBodyAcc.mad...X + fBodyAcc.mad...Y + 
    fBodyAcc.mad...Z + fBodyAcc.max...X + fBodyAcc.max...Y + 
    fBodyAcc.max...Z + fBodyAcc.min...X + fBodyAcc.min...Y + 
    fBodyAcc.min...Z + fBodyAcc.sma.. + fBodyAcc.energy...X + 
    fBodyAcc.energy...Y + fBodyAcc.energy...Z + fBodyAcc.iqr...X + 
    fBodyAcc.iqr...Y + fBodyAcc.iqr...Z + fBodyAcc.entropy...X + 
    fBodyAcc.entropy...Y + fBodyAcc.entropy...Z + fBodyAcc.maxInds.X + 
    fBodyAcc.maxInds.Y + fBodyAcc.maxInds.Z + fBodyAcc.meanFreq...X + 
    fBodyAcc.meanFreq...Y + fBodyAcc.meanFreq...Z + fBodyAcc.skewness...X + 
    fBodyAcc.kurtosis...X + fBodyAcc.skewness...Y + fBodyAcc.kurtosis...Y + 
    fBodyAcc.skewness...Z + fBodyAcc.kurtosis...Z + fBodyAcc.bandsEnergy...1.8 + 
    fBodyAcc.bandsEnergy...9.16 + fBodyAcc.bandsEnergy...17.24 + 
    fBodyAcc.bandsEnergy...25.32 + fBodyAcc.bandsEnergy...33.40 + 
    fBodyAcc.bandsEnergy...41.48 + fBodyAcc.bandsEnergy...49.56 + 
    fBodyAcc.bandsEnergy...57.64 + fBodyAcc.bandsEnergy...1.16 + 
    fBodyAcc.bandsEnergy...17.32 + fBodyAcc.bandsEnergy...33.48 + 
    fBodyAcc.bandsEnergy...49.64 + fBodyAcc.bandsEnergy...1.24 + 
    fBodyAcc.bandsEnergy...25.48 + fBodyAcc.bandsEnergy...1.8.1 + 
    fBodyAcc.bandsEnergy...9.16.1 + fBodyAcc.bandsEnergy...17.24.1 + 
    fBodyAcc.bandsEnergy...25.32.1 + fBodyAcc.bandsEnergy...33.40.1 + 
    fBodyAcc.bandsEnergy...41.48.1 + fBodyAcc.bandsEnergy...49.56.1 + 
    fBodyAcc.bandsEnergy...57.64.1 + fBodyAcc.bandsEnergy...1.16.1 + 
    fBodyAcc.bandsEnergy...17.32.1 + fBodyAcc.bandsEnergy...33.48.1 + 
    fBodyAcc.bandsEnergy...49.64.1 + fBodyAcc.bandsEnergy...1.24.1 + 
    fBodyAcc.bandsEnergy...25.48.1 + fBodyAcc.bandsEnergy...1.8.2 + 
    fBodyAcc.bandsEnergy...9.16.2 + fBodyAcc.bandsEnergy...17.24.2 + 
    fBodyAcc.bandsEnergy...25.32.2 + fBodyAcc.bandsEnergy...33.40.2 + 
    fBodyAcc.bandsEnergy...41.48.2 + fBodyAcc.bandsEnergy...49.56.2 + 
    fBodyAcc.bandsEnergy...57.64.2 + fBodyAcc.bandsEnergy...1.16.2 + 
    fBodyAcc.bandsEnergy...17.32.2 + fBodyAcc.bandsEnergy...33.48.2 + 
    fBodyAcc.bandsEnergy...49.64.2 + fBodyAcc.bandsEnergy...1.24.2 + 
    fBodyAcc.bandsEnergy...25.48.2 + fBodyAccJerk.mean...X + 
    fBodyAccJerk.mean...Y + fBodyAccJerk.mean...Z + fBodyAccJerk.std...X + 
    fBodyAccJerk.std...Y + fBodyAccJerk.std...Z + fBodyAccJerk.mad...X + 
    fBodyAccJerk.mad...Y + fBodyAccJerk.mad...Z + fBodyAccJerk.max...X + 
    fBodyAccJerk.max...Y + fBodyAccJerk.max...Z + fBodyAccJerk.min...X + 
    fBodyAccJerk.min...Y + fBodyAccJerk.min...Z + fBodyAccJerk.sma.. + 
    fBodyAccJerk.energy...X + fBodyAccJerk.energy...Y + fBodyAccJerk.energy...Z + 
    fBodyAccJerk.iqr...X + fBodyAccJerk.iqr...Y + fBodyAccJerk.iqr...Z + 
    fBodyAccJerk.entropy...X + fBodyAccJerk.entropy...Y + fBodyAccJerk.entropy...Z + 
    fBodyAccJerk.maxInds.X + fBodyAccJerk.maxInds.Y + fBodyAccJerk.maxInds.Z + 
    fBodyAccJerk.meanFreq...X + fBodyAccJerk.meanFreq...Y + fBodyAccJerk.meanFreq...Z + 
    fBodyAccJerk.skewness...X + fBodyAccJerk.kurtosis...X + fBodyAccJerk.skewness...Y + 
    fBodyAccJerk.kurtosis...Y + fBodyAccJerk.skewness...Z + fBodyAccJerk.kurtosis...Z + 
    fBodyAccJerk.bandsEnergy...1.8 + fBodyAccJerk.bandsEnergy...9.16 + 
    fBodyAccJerk.bandsEnergy...17.24 + fBodyAccJerk.bandsEnergy...25.32 + 
    fBodyAccJerk.bandsEnergy...33.40 + fBodyAccJerk.bandsEnergy...41.48 + 
    fBodyAccJerk.bandsEnergy...49.56 + fBodyAccJerk.bandsEnergy...57.64 + 
    fBodyAccJerk.bandsEnergy...1.16 + fBodyAccJerk.bandsEnergy...17.32 + 
    fBodyAccJerk.bandsEnergy...33.48 + fBodyAccJerk.bandsEnergy...49.64 + 
    fBodyAccJerk.bandsEnergy...1.24 + fBodyAccJerk.bandsEnergy...25.48 + 
    fBodyAccJerk.bandsEnergy...1.8.1 + fBodyAccJerk.bandsEnergy...9.16.1 + 
    fBodyAccJerk.bandsEnergy...17.24.1 + fBodyAccJerk.bandsEnergy...25.32.1 + 
    fBodyAccJerk.bandsEnergy...33.40.1 + fBodyAccJerk.bandsEnergy...41.48.1 +fBodyAccJerk.bandsEnergy...49.56.1 + fBodyAccJerk.bandsEnergy...57.64.1 + 
    fBodyAccJerk.bandsEnergy...1.16.1 + fBodyAccJerk.bandsEnergy...17.32.1 + 
    fBodyAccJerk.bandsEnergy...33.48.1 + fBodyAccJerk.bandsEnergy...49.64.1 + 
    fBodyAccJerk.bandsEnergy...1.24.1 + fBodyAccJerk.bandsEnergy...25.48.1 + 
    fBodyAccJerk.bandsEnergy...1.8.2 + fBodyAccJerk.bandsEnergy...9.16.2 + 
    fBodyAccJerk.bandsEnergy...17.24.2 + fBodyAccJerk.bandsEnergy...25.32.2 + 
    fBodyAccJerk.bandsEnergy...33.40.2 + fBodyAccJerk.bandsEnergy...41.48.2 + 
    fBodyAccJerk.bandsEnergy...49.56.2 + fBodyAccJerk.bandsEnergy...57.64.2 + 
    fBodyAccJerk.bandsEnergy...1.16.2 + fBodyAccJerk.bandsEnergy...17.32.2 + 
    fBodyAccJerk.bandsEnergy...33.48.2 + fBodyAccJerk.bandsEnergy...49.64.2 + 
    fBodyAccJerk.bandsEnergy...1.24.2 + fBodyAccJerk.bandsEnergy...25.48.2 + 
    fBodyGyro.mean...X + fBodyGyro.mean...Y + fBodyGyro.mean...Z + 
    fBodyGyro.std...X + fBodyGyro.std...Y + fBodyGyro.std...Z + 
    fBodyGyro.mad...X + fBodyGyro.mad...Y + fBodyGyro.mad...Z + 
    fBodyGyro.max...X + fBodyGyro.max...Y + fBodyGyro.max...Z + 
    fBodyGyro.min...X + fBodyGyro.min...Y + fBodyGyro.min...Z + 
    fBodyGyro.sma.. + fBodyGyro.energy...X + fBodyGyro.energy...Y + 
    fBodyGyro.energy...Z + fBodyGyro.iqr...X + fBodyGyro.iqr...Y + 
    fBodyGyro.iqr...Z + fBodyGyro.entropy...X + fBodyGyro.entropy...Y + 
    fBodyGyro.entropy...Z + fBodyGyro.maxInds.X + fBodyGyro.maxInds.Y + 
    fBodyGyro.maxInds.Z + fBodyGyro.meanFreq...X + fBodyGyro.meanFreq...Y + 
    fBodyGyro.meanFreq...Z + fBodyGyro.skewness...X + fBodyGyro.kurtosis...X + 
    fBodyGyro.skewness...Y + fBodyGyro.kurtosis...Y + fBodyGyro.skewness...Z + 
    fBodyGyro.kurtosis...Z + fBodyGyro.bandsEnergy...1.8 + fBodyGyro.bandsEnergy...9.16 + 
    fBodyGyro.bandsEnergy...17.24 + fBodyGyro.bandsEnergy...25.32 + 
    fBodyGyro.bandsEnergy...33.40 + fBodyGyro.bandsEnergy...41.48 + 
    fBodyGyro.bandsEnergy...49.56 + fBodyGyro.bandsEnergy...57.64 + 
    fBodyGyro.bandsEnergy...1.16 + fBodyGyro.bandsEnergy...17.32 + 
    fBodyGyro.bandsEnergy...33.48 + fBodyGyro.bandsEnergy...49.64 + 
    fBodyGyro.bandsEnergy...1.24 + fBodyGyro.bandsEnergy...25.48 + 
    fBodyGyro.bandsEnergy...1.8.1 + fBodyGyro.bandsEnergy...9.16.1 + 
    fBodyGyro.bandsEnergy...17.24.1 + fBodyGyro.bandsEnergy...25.32.1 + 
    fBodyGyro.bandsEnergy...33.40.1 + fBodyGyro.bandsEnergy...41.48.1 + 
    fBodyGyro.bandsEnergy...49.56.1 + fBodyGyro.bandsEnergy...57.64.1 + 
    fBodyGyro.bandsEnergy...1.16.1 + fBodyGyro.bandsEnergy...17.32.1 + 
    fBodyGyro.bandsEnergy...33.48.1 + fBodyGyro.bandsEnergy...49.64.1 + 
    fBodyGyro.bandsEnergy...1.24.1 + fBodyGyro.bandsEnergy...25.48.1 + 
    fBodyGyro.bandsEnergy...1.8.2 + fBodyGyro.bandsEnergy...9.16.2 + 
    fBodyGyro.bandsEnergy...17.24.2 + fBodyGyro.bandsEnergy...25.32.2 + 
    fBodyGyro.bandsEnergy...33.40.2 + fBodyGyro.bandsEnergy...41.48.2 + 
    fBodyGyro.bandsEnergy...49.56.2 + fBodyGyro.bandsEnergy...57.64.2 + 
    fBodyGyro.bandsEnergy...1.16.2 + fBodyGyro.bandsEnergy...17.32.2 + 
    fBodyGyro.bandsEnergy...33.48.2 + fBodyGyro.bandsEnergy...49.64.2 + 
    fBodyGyro.bandsEnergy...1.24.2 + fBodyGyro.bandsEnergy...25.48.2 + 
    fBodyAccMag.mean.. + fBodyAccMag.std.. + fBodyAccMag.mad.. + 
    fBodyAccMag.max.. + fBodyAccMag.min.. + fBodyAccMag.sma.. + 
    fBodyAccMag.energy.. + fBodyAccMag.iqr.. + fBodyAccMag.entropy.. + 
    fBodyAccMag.maxInds + fBodyAccMag.meanFreq.. + fBodyAccMag.skewness.. + 
    fBodyAccMag.kurtosis.. + fBodyBodyAccJerkMag.mean.. + fBodyBodyAccJerkMag.std.. + 
    fBodyBodyAccJerkMag.mad.. + fBodyBodyAccJerkMag.max.. + fBodyBodyAccJerkMag.min.. + 
    fBodyBodyAccJerkMag.sma.. + fBodyBodyAccJerkMag.energy.. + 
    fBodyBodyAccJerkMag.iqr.. + fBodyBodyAccJerkMag.entropy.. + 
    fBodyBodyAccJerkMag.maxInds + fBodyBodyAccJerkMag.meanFreq.. + 
    fBodyBodyAccJerkMag.skewness.. + fBodyBodyAccJerkMag.kurtosis.. + fBodyBodyGyroMag.mean.. + fBodyBodyGyroMag.std.. + fBodyBodyGyroMag.mad.. + 
    fBodyBodyGyroMag.max.. + fBodyBodyGyroMag.min.. + fBodyBodyGyroMag.sma.. + 
    fBodyBodyGyroMag.energy.. + fBodyBodyGyroMag.iqr.. + fBodyBodyGyroMag.entropy.. + 
    fBodyBodyGyroMag.maxInds + fBodyBodyGyroMag.meanFreq.. + 
    fBodyBodyGyroMag.skewness.. + fBodyBodyGyroMag.kurtosis.. + 
    fBodyBodyGyroJerkMag.mean.. + fBodyBodyGyroJerkMag.std.. + 
    fBodyBodyGyroJerkMag.mad.. + fBodyBodyGyroJerkMag.max.. + 
    fBodyBodyGyroJerkMag.min.. + fBodyBodyGyroJerkMag.sma.. + 
    fBodyBodyGyroJerkMag.energy.. + fBodyBodyGyroJerkMag.iqr.. + 
    fBodyBodyGyroJerkMag.entropy.. + fBodyBodyGyroJerkMag.maxInds + 
    fBodyBodyGyroJerkMag.meanFreq.. + fBodyBodyGyroJerkMag.skewness.. + 
    fBodyBodyGyroJerkMag.kurtosis.. + angle.tBodyAccMean.gravity. + 
    angle.tBodyAccJerkMean..gravityMean. + angle.tBodyGyroMean.gravityMean. + 
    angle.tBodyGyroJerkMean.gravityMean. + angle.X.gravityMean. + 
    angle.Y.gravityMean. + angle.Z.gravityMean. + subject
  , train.data,  hidden = c(6, 6), linear.output = FALSE, threshold=0.3)
```

```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (training set)
train.data3 <- train.data
training.prediction <- compute(nn10, train.data3[,1:562])
training.class <- apply(training.prediction$net.result,1,which.max)-1


revalue(train.data3$Activity, c("LAYING" = 0)) -> train.data3$Activity
revalue(train.data3$Activity, c("SITTING" = 1)) -> train.data3$Activity
revalue(train.data3$Activity, c("STANDING" = 2)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING" = 3)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> train.data3$Activity
revalue(train.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> train.data3$Activity


original_values <- as.factor(train.data3$Activity)
mean(as.factor(training.class) == original_values)
confusionMatrix(as.factor(training.class), as.factor(train.data3$Activity))
table(as.factor(train.data3$Activity), training.class)


```






```{r,include= TRUE, echo =TRUE, warning = FALSE,message = FALSE}
# Accuracy (testing set)
valid.data3 <- valid.data
validation.prediction <- compute(nn10, valid.data3[,1:562])
validation.class <- apply(validation.prediction$net.result,1,which.max)-1


revalue(valid.data3$Activity, c("LAYING" = 0)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("SITTING" = 1)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("STANDING" = 2)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING" = 3)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_DOWNSTAIRS" = 4)) -> valid.data3$Activity
revalue(valid.data3$Activity, c("WALKING_UPSTAIRS" = 5)) -> valid.data3$Activity


original_values_valid <- as.factor(valid.data3$Activity)
mean(as.factor(validation.class) == original_values_valid)
confusionMatrix(as.factor(validation.class), as.factor(valid.data3$Activity))
table(as.factor(valid.data3$Activity), validation.class)


```


























































